<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="DA FlatBuffers - Binary serialization with field-level encryption">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DA FlatBuffers</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;600;700&family=SF+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Video Background -->
  <div class="video-background">
    <video autoplay loop muted playsinline id="bg-video">
      <source src="./videos/bg-1.mp4" type="video/mp4">
    </video>
    <div class="video-overlay"></div>
  </div>

  <!-- Navigation -->
  <nav class="nav-bar">
    <div class="nav-content">
      <a href="https://github.com/DigitalArsenal/flatbuffers" target="_blank" class="nav-logo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
        </svg>
        <span>DA FlatBuffers</span>
      </a>
      <div class="nav-links" id="demo-nav-links">
        <a href="#overview" class="nav-link active" data-tab="overview">Overview</a>
        <a href="#pki" class="nav-link" data-tab="pki">PKI</a>
        <a href="#adversarial" class="nav-link" data-tab="adversarial">Security</a>
        <a href="#fields" class="nav-link" data-tab="fields">Field Encryption</a>
        <a href="#schema" class="nav-link" data-tab="schema">Schema</a>
        <a href="#streaming" class="nav-link" data-tab="streaming">Streaming</a>
        <a href="#identity" class="nav-link" data-tab="identity">Identity</a>
        <a href="#studio" class="nav-link" data-tab="studio">Studio</a>
        <a href="#aligned" class="nav-link" data-tab="aligned">Aligned</a>
        <a href="#runtimes" class="nav-link" data-tab="runtimes">Runtimes</a>
        <span class="nav-divider"></span>
        <a href="https://flatbuffers.dev" target="_blank" class="nav-link nav-link-external">Docs</a>
        <span id="nav-status" class="nav-status"></span>
      </div>
      <div class="nav-actions">
        <button id="nav-login" class="nav-btn glass-btn primary">Login</button>
        <button id="nav-keys" class="nav-btn glass-btn" style="display: none;" title="Account & Keys">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="8" r="4"/>
            <path d="M20 21a8 8 0 1 0-16 0"/>
          </svg>
        </button>
        <button id="nav-logout" class="nav-btn glass-btn" style="display: none;">Logout</button>
        <button id="nav-menu-btn" class="nav-menu-btn" aria-label="Toggle menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6"/>
            <line x1="3" y1="12" x2="21" y2="12"/>
            <line x1="3" y1="18" x2="21" y2="18"/>
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="nav-mobile-menu" class="nav-mobile-menu">
    <a href="#overview" class="nav-link" data-tab="overview">Overview</a>
    <a href="#pki" class="nav-link" data-tab="pki">PKI</a>
    <a href="#adversarial" class="nav-link" data-tab="adversarial">Security</a>
    <a href="#fields" class="nav-link" data-tab="fields">Field Encryption</a>
    <a href="#schema" class="nav-link" data-tab="schema">Schema</a>
    <a href="#streaming" class="nav-link" data-tab="streaming">Streaming</a>
    <a href="#identity" class="nav-link" data-tab="identity">Identity</a>
    <a href="#studio" class="nav-link" data-tab="studio">Studio</a>
    <a href="#aligned" class="nav-link" data-tab="aligned">Aligned</a>
    <a href="#runtimes" class="nav-link" data-tab="runtimes">Runtimes</a>
    <span class="nav-divider"></span>
    <a href="https://flatbuffers.dev" target="_blank" class="nav-link nav-link-external">Docs</a>
  </div>

  <!-- Hero / Login Section -->
  <section id="hero-section" class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">Digital Arsenal<br/>Flatbuffers</h1>
      <p class="hero-subtitle">Blazing fast data transmission with field-level encryption, compatible with all major crypto networks.  <br/> <br/><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener">Apache 2.0</a> licensed, free and open source.</p>
      <!-- CI Status Badges -->
      <div class="ci-badges">
        <a href="https://github.com/DigitalArsenal/flatbuffers/actions/workflows/build.yml" target="_blank">
          <img src="https://github.com/DigitalArsenal/flatbuffers/actions/workflows/build.yml/badge.svg" alt="Build Status">
        </a>
        <a href="https://github.com/DigitalArsenal/flatbuffers/actions/workflows/docs.yml" target="_blank">
          <img src="https://github.com/DigitalArsenal/flatbuffers/actions/workflows/docs.yml/badge.svg" alt="Docs Status">
        </a>
        <a href="https://github.com/DigitalArsenal/flatbuffers" target="_blank">
          <img src="https://img.shields.io/github/stars/DigitalArsenal/flatbuffers?style=social" alt="GitHub Stars">
        </a>
        <a href="https://github.com/DigitalArsenal/flatbuffers/fork" target="_blank">
          <img src="https://img.shields.io/github/forks/DigitalArsenal/flatbuffers?style=social" alt="GitHub Forks">
        </a>
      </div>
      <div class="contact-info">
        <a href="javascript:void(0)" class="contact-link" data-u="tj" data-d="digitalarsenal.io"></a>
      </div>

      <div class="hero-stats hidden" id="hero-stats">
        <div class="stat-item">
          <span class="stat-value" id="hero-wallet-type">BTC</span>
          <span class="stat-label">Network</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="hero-address">--</span>
          <span class="stat-label">Address</span>
        </div>
      </div>
    </div>

    <div class="scroll-indicator" id="scroll-indicator" style="display: none;">
      <span>Scroll to explore</span>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M19 12l-7 7-7-7"></path>
      </svg>
    </div>
  </section>

  <!-- Main App Content -->
  <main id="main-app" class="main-app">

    <!-- Overview Section - Compliance and capabilities -->
    <section id="overview-tab" class="content-section active">
      <div class="section-header">
        <h2 class="section-title">Field-Level Encryption for FlatBuffers</h2>
        <p class="section-desc">AES-256 encryption with HD wallet key derivation, meeting federal data-at-rest requirements</p>
      </div>

      <div class="glass-card">
        <h3 class="card-subtitle">Capabilities</h3>
        <div class="overview-grid">
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>Field-Level Encryption</h4>
              <p>Encrypt individual fields within FlatBuffer records. The binary structure stays intact so upstream code can read encrypted values without schema changes.</p>
            </div>
          </div>
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>HD Wallet Key Derivation</h4>
              <p>Keys derived from BIP-39 seed phrases using HKDF-SHA256. Each field can have its own derived key for granular access control.</p>
            </div>
          </div>
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>High Performance</h4>
              <p>Generate and encrypt 1 million records at 50+ MB/s using WebAssembly. Streaming export avoids memory accumulation.</p>
            </div>
          </div>
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 6v6l4 2"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>Zero Server Dependency</h4>
              <p>All cryptographic operations run client-side in the browser. No data leaves your device unless you explicitly export it.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="glass-card">
        <h3 class="card-subtitle">Cryptographic Implementation</h3>
        <div class="crypto-specs">
          <div class="spec-row">
            <span class="spec-label">Symmetric Encryption</span>
            <span class="spec-value">AES-256-CTR</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Key Derivation</span>
            <span class="spec-value">HKDF-SHA256</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Key Exchange</span>
            <span class="spec-value">X25519 ECDH (Curve25519)</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Digital Signatures</span>
            <span class="spec-value">Ed25519</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">HD Wallet</span>
            <span class="spec-value">BIP-39 / BIP-32 / BIP-44</span>
          </div>
          <div class="spec-row">
            <span class="spec-label">Runtime</span>
            <span class="spec-value" id="crypto-runtime">WebAssembly (Crypto++)</span>
          </div>
          <div class="spec-row" id="fips-mode-row" style="display: none;">
            <span class="spec-label">FIPS 140-3</span>
            <span class="spec-value fips-indicator" id="fips-mode-value">
              <span class="fips-badge">FIPS Mode</span>
              OpenSSL Provider (P-256, AES-256-GCM)
            </span>
          </div>
        </div>
      </div>

      <div class="glass-card">
        <h3 class="card-subtitle">Federal Compliance Standards</h3>
        <p class="card-desc">This implementation uses cryptographic algorithms approved for protecting federal data at rest:</p>

        <div class="compliance-grid">
          <a href="https://media.defense.gov/2022/Sep/07/2003071836/-1/-1/0/CSI_CNSA_2.0_FAQ_.PDF" target="_blank" class="compliance-card">
            <div class="compliance-header">
              <span class="compliance-badge">NSA</span>
              <h4>CNSA 2.0</h4>
            </div>
            <p>Commercial National Security Algorithm Suite 2.0 mandates AES-256 for all National Security Systems. Quantum-resistant algorithm support required by 2025.</p>
            <span class="compliance-link">View PDF &rarr;</span>
          </a>

          <a href="https://csrc.nist.gov/pubs/sp/800/111/final" target="_blank" class="compliance-card">
            <div class="compliance-header">
              <span class="compliance-badge">NIST</span>
              <h4>SP 800-111</h4>
            </div>
            <p>Guide to Storage Encryption Technologies for End User Devices. Endorses AES-256 for data at rest with proper key management.</p>
            <span class="compliance-link">View Publication &rarr;</span>
          </a>

          <a href="https://csrc.nist.gov/pubs/fips/140-3/final" target="_blank" class="compliance-card">
            <div class="compliance-header">
              <span class="compliance-badge">FIPS</span>
              <h4>140-3</h4>
            </div>
            <p>Security Requirements for Cryptographic Modules. AES-256 is approved for all security levels (1-4) in federal cryptographic modules.</p>
            <span class="compliance-link">View Standard &rarr;</span>
          </a>

          <a href="https://www.cyber.mil/stigs" target="_blank" class="compliance-card">
            <div class="compliance-header">
              <span class="compliance-badge">DoD</span>
              <h4>STIGs</h4>
            </div>
            <p>Security Technical Implementation Guides require FIPS 140-validated AES encryption for protecting CUI and classified information.</p>
            <span class="compliance-link">View STIG Library &rarr;</span>
          </a>
        </div>

        <div class="compliance-note">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4M12 8h.01"/>
          </svg>
          <span><strong>Cryptographic Backends:</strong> Default build uses Crypto++ (FIPS 140-2, full algorithm support including X25519/Ed25519/secp256k1). For FIPS 140-3 compliance, an OpenSSL 3.0.9 FIPS Provider build is available (Certificate #4282, NIST curves only). See <code>wasm/openssl-fips/</code>.</span>
        </div>
      </div>

      <div class="glass-card">
        <h3 class="card-subtitle">Use Cases</h3>
        <div class="usecases-grid">
          <div class="usecase-item">
            <h4>Defense &amp; Intelligence</h4>
            <p>Field-level encryption for mission data with per-user key derivation and need-to-know access control.</p>
          </div>
          <div class="usecase-item">
            <h4>Healthcare (HIPAA)</h4>
            <p>Encrypt PHI fields while leaving non-sensitive metadata readable for indexing and routing.</p>
          </div>
          <div class="usecase-item">
            <h4>Financial Services</h4>
            <p>Protect PII and transaction data at rest with audit-ready key management from HD wallets.</p>
          </div>
          <div class="usecase-item">
            <h4>Zero-Trust Architectures</h4>
            <p>Data remains encrypted until the authorized recipient decrypts with their derived key.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- PKI Section (Alice/Bob Public Key Encryption) -->
    <section id="pki-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Public Key Infrastructure</h2>
        <p class="section-desc">Alice encrypts data with Bob's public key. Only Bob can decrypt with his private key.</p>
      </div>

      <div class="glass-card">
        <div class="card-controls" id="pki-controls" style="display: none;">
          <div class="algorithm-display">
            <span class="algorithm-label">Algorithm:</span>
            <span id="pki-algorithm-display" class="algorithm-value">X25519</span>
          </div>
          <button id="pki-clear-keys" class="glass-btn" style="display: none;">Clear Saved Keys</button>
        </div>

        <!-- Key Pairs Display -->
        <div class="pki-parties" id="pki-parties" style="display: none;">
          <div class="pki-party alice">
            <div class="party-header">
              <span class="party-icon">A</span>
              <span class="party-name">Alice (Sender)</span>
            </div>
            <div class="derivation-path">
              <label>HD Path</label>
              <code id="alice-path">m/44'/0'/0'/0/0</code>
            </div>
            <div class="key-item">
              <label>Public Key</label>
              <code id="alice-public-key">--</code>
            </div>
            <div class="key-item private-key">
              <label>Private Key <span class="key-warning-badge">Secret</span></label>
              <code id="alice-private-key" class="blur-key">--</code>
            </div>
          </div>

          <div class="pki-arrow">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
            <span>Encrypted with Bob's Public Key</span>
          </div>

          <div class="pki-party bob">
            <div class="party-header">
              <span class="party-icon">B</span>
              <span class="party-name">Bob (Recipient)</span>
            </div>
            <div class="derivation-path">
              <label>HD Path</label>
              <code id="bob-path">m/44'/0'/0'/0/1</code>
            </div>
            <div class="key-item">
              <label>Public Key</label>
              <code id="bob-public-key">--</code>
            </div>
            <div class="key-item private-key">
              <label>Private Key <span class="key-warning-badge">Secret</span></label>
              <code id="bob-private-key" class="blur-key">--</code>
            </div>
          </div>
        </div>

        <!-- Login prompt for demo (shown when not logged in) -->
        <div class="pki-login-prompt" id="pki-login-prompt">
          <div class="login-prompt-content">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
            <p>Login to try the interactive encryption demo</p>
            <a href="#hero-section" class="glass-btn primary">Login</a>
          </div>
        </div>

        <!-- How It Works Explanation -->
        <div class="encryption-explainer" id="encryption-explainer">
          <h3 class="card-subtitle">How ECIES Encryption Works</h3>
          <div class="explainer-grid">
            <div class="explainer-card">
              <div class="explainer-icon">1</div>
              <div class="explainer-content">
                <h4>Ephemeral Key Generation</h4>
                <p>Alice generates a one-time ephemeral key pair for each encryption. This provides <strong>forward secrecy</strong> - if Alice's main key is compromised, past messages remain secure.</p>
              </div>
            </div>
            <div class="explainer-card">
              <div class="explainer-icon">2</div>
              <div class="explainer-content">
                <h4>ECDH Key Exchange</h4>
                <p>Alice uses her ephemeral private key and Bob's public key to compute a <strong>shared secret</strong> via Elliptic Curve Diffie-Hellman. Only Alice and Bob can derive this shared secret.</p>
              </div>
            </div>
            <div class="explainer-card">
              <div class="explainer-icon">3</div>
              <div class="explainer-content">
                <h4>HKDF Key Derivation</h4>
                <p>The shared secret is passed through <strong>HKDF-SHA256</strong> to derive a symmetric AES-256 key and nonce. This stretches the shared secret into cryptographically strong key material.</p>
              </div>
            </div>
            <div class="explainer-card">
              <div class="explainer-icon">4</div>
              <div class="explainer-content">
                <h4>AES-256-CTR Encryption</h4>
                <p>Data is encrypted using <strong>AES-256 in CTR mode</strong>. CTR mode is a stream cipher that preserves plaintext length - critical for FlatBuffers where field sizes must remain constant.</p>
              </div>
            </div>
            <div class="explainer-card">
              <div class="explainer-icon">5</div>
              <div class="explainer-content">
                <h4>Header Transmission</h4>
                <p>The ephemeral public key and nonce are sent as a <strong>header</strong> alongside the ciphertext. Bob uses this header plus his private key to derive the same symmetric key and decrypt.</p>
              </div>
            </div>
          </div>
          <div class="explainer-note">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 16v-4M12 8h.01"/>
            </svg>
            <span><strong>Why CTR mode?</strong> FlatBuffers uses fixed-size fields with known offsets. CTR mode encrypts each field to the same length as the plaintext, preserving the binary structure. Block cipher modes like CBC would add padding and break the schema.</span>
          </div>
        </div>

        <!-- Encryption Demo -->
        <div class="pki-demo" id="pki-demo" style="display: none;">
          <h3 class="card-subtitle">Encryption Flow</h3>

          <div class="pki-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <label>Alice's Message (Plaintext)</label>
              <textarea id="pki-plaintext" class="glass-input glass-textarea" rows="2" placeholder="Enter a secret message for Bob..."></textarea>
            </div>
          </div>

          <div class="pki-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <button id="pki-encrypt" class="glass-btn primary">Encrypt for Bob</button>
              <p class="step-desc">Alice encrypts using Bob's public key. An ephemeral key pair is generated for forward secrecy.</p>
            </div>
          </div>

          <div class="pki-step" id="pki-ciphertext-step" style="display: none;">
            <div class="step-number">3</div>
            <div class="step-content">
              <label>Ciphertext (Sent to Bob)</label>
              <code id="pki-ciphertext" class="hex-display">--</code>
              <label style="margin-top: 0.5rem;">Encryption Header (ECIES Metadata)</label>
              <pre id="pki-header" class="header-json">--</pre>
            </div>
          </div>

          <div class="pki-step" id="pki-decrypt-step" style="display: none;">
            <div class="step-number">4</div>
            <div class="step-content">
              <button id="pki-decrypt" class="glass-btn">Bob Decrypts</button>
              <p class="step-desc">Bob uses his private key to decrypt the message.</p>
            </div>
          </div>

          <div class="pki-step" id="pki-result-step" style="display: none;">
            <div class="step-number">5</div>
            <div class="step-content">
              <label>Decrypted Message (Bob sees)</label>
              <div id="pki-decrypted" class="decrypted-result">--</div>
              <div class="verification-badge" id="pki-verification">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                <span>Decryption successful - Messages match!</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Wrong Key Demo -->
        <div class="pki-security" id="pki-security" style="display: none;">
          <h3 class="card-subtitle">Security Demonstration</h3>
          <button id="pki-wrong-key" class="glass-btn">Try Decrypting with Alice's Key</button>
          <div id="pki-wrong-result" class="wrong-key-result" style="display: none;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="15" y1="9" x2="9" y2="15"/>
              <line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
            <span>Decryption failed - Only Bob's private key can decrypt!</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Adversarial Security Section - Blockchain-based key integrity verification -->
    <section id="adversarial-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Adversarial Security</h2>
        <p class="section-desc">Cryptographic keys derive blockchain addresses. Value at an address proves key integrity.</p>
      </div>

      <!-- Always-visible explanation card -->
      <div class="glass-card adversarial-intro-card">
        <div class="adversarial-intro">
          <div class="intro-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" fill="white" stroke="white" stroke-width="1.5"/>
              <path d="M9 12l2 2 4-4" stroke="#22c55e" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="intro-content">
            <h3>What is Adversarial Security?</h3>
            <p>A novel trust mechanism where <strong>cryptocurrency value acts as a security bond</strong> for cryptographic keys. The same public key used for encryption can derive addresses on blockchain networks. If significant value remains at those addresses without being drained, it provides strong evidence that the private key hasn't been compromised.</p>
          </div>
        </div>

        <div class="adversarial-principles">
          <div class="principle">
            <div class="principle-number">1</div>
            <div class="principle-content">
              <h4>Key Derivation</h4>
              <p>Any cryptographic public key (secp256k1, Ed25519) can mathematically derive addresses on cryptocurrency networks like SUI and Monad. This is a one-way function &mdash; the address is uniquely tied to that key.</p>
            </div>
          </div>
          <div class="principle">
            <div class="principle-number">2</div>
            <div class="principle-content">
              <h4>Value as Trust Signal</h4>
              <p>Anyone can send cryptocurrency to an address <em>without permission</em>. If you rely on a key being secure, you can deposit funds as a "security bond." The more value at stake, the higher the trust signal.</p>
            </div>
          </div>
          <div class="principle">
            <div class="principle-number">3</div>
            <div class="principle-content">
              <h4>Adversarial Assumption</h4>
              <p>If a private key is compromised, a rational attacker drains the funds immediately. <strong>Undrained value = uncompromised key.</strong> Data signed by that key, or encrypted for it, can be trusted.</p>
            </div>
          </div>
          <div class="principle">
            <div class="principle-number">4</div>
            <div class="principle-content">
              <h4>Real-Time Proof</h4>
              <p>Blockchain explorers show balances updated every block. This provides <strong>continuous, verifiable proof</strong> of key integrity &mdash; not a point-in-time certificate, but live security monitoring.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="glass-card">
        <!-- Concept Explainer with Animation -->
        <div class="adversarial-concept" id="adversarial-concept">
          <h3 class="card-subtitle">Trust Through Value</h3>
          <p class="concept-intro">The flow below shows how a public key transforms into verifiable trust through blockchain-secured value.</p>

          <!-- Animated Flow Diagram -->
          <div class="adversarial-flow">
            <svg class="flow-diagram" viewBox="0 0 800 120" preserveAspectRatio="xMidYMid meet">
              <!-- Key Icon -->
              <g class="flow-step" transform="translate(50, 20)">
                <circle cx="40" cy="40" r="35" fill="none" stroke="var(--white-30)" stroke-width="2"/>
                <g transform="translate(24, 24)" stroke="var(--white-60)" stroke-width="2" fill="none">
                  <circle cx="10" cy="8" r="6"/>
                  <path d="M14 12 L26 24 M22 20 L26 24 L22 28"/>
                </g>
                <text x="40" y="95" text-anchor="middle" fill="var(--white-60)" font-size="11">Public Key</text>
              </g>

              <!-- Arrow 1 -->
              <g class="flow-arrow arrow-1" transform="translate(130, 40)">
                <line x1="0" y1="20" x2="80" y2="20" stroke="var(--white-20)" stroke-width="2" stroke-dasharray="4,4"/>
                <polygon points="80,20 70,15 70,25" fill="var(--white-30)"/>
                <text x="40" y="50" text-anchor="middle" fill="var(--white-40)" font-size="9">derives</text>
              </g>

              <!-- Address Icon (Hexagon) -->
              <g class="flow-step" transform="translate(220, 20)">
                <polygon points="40,5 70,22 70,58 40,75 10,58 10,22" fill="none" stroke="var(--white-30)" stroke-width="2"/>
                <text x="40" y="45" text-anchor="middle" fill="var(--white-50)" font-size="10" font-family="var(--font-mono)">0x...</text>
                <text x="40" y="95" text-anchor="middle" fill="var(--white-60)" font-size="11">Address</text>
              </g>

              <!-- Arrow 2 -->
              <g class="flow-arrow arrow-2" transform="translate(300, 40)">
                <line x1="0" y1="20" x2="80" y2="20" stroke="var(--white-20)" stroke-width="2" stroke-dasharray="4,4"/>
                <polygon points="80,20 70,15 70,25" fill="var(--white-30)"/>
                <text x="40" y="50" text-anchor="middle" fill="var(--white-40)" font-size="9">holds</text>
              </g>

              <!-- Value Icon (Money/Dollar) -->
              <g class="flow-step" transform="translate(390, 20)">
                <circle cx="40" cy="40" r="28" fill="none" stroke="var(--white-30)" stroke-width="2"/>
                <text x="40" y="52" text-anchor="middle" fill="var(--white-50)" font-size="32" font-weight="bold">$</text>
                <text x="40" y="95" text-anchor="middle" fill="var(--white-60)" font-size="11">Value</text>
              </g>

              <!-- Arrow 3 -->
              <g class="flow-arrow arrow-3" transform="translate(470, 40)">
                <line x1="0" y1="20" x2="80" y2="20" stroke="var(--white-20)" stroke-width="2" stroke-dasharray="4,4"/>
                <polygon points="80,20 70,15 70,25" fill="var(--white-30)"/>
                <text x="40" y="50" text-anchor="middle" fill="var(--white-40)" font-size="9">proves</text>
              </g>

              <!-- Shield Icon (Trust) -->
              <g class="flow-step trust-icon" transform="translate(560, 20)">
                <path d="M40 10 L65 20 L65 45 Q65 65 40 75 Q15 65 15 45 L15 20 Z" fill="none" stroke="var(--success)" stroke-width="2"/>
                <polyline points="28,42 36,50 52,34" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <text x="40" y="95" text-anchor="middle" fill="var(--success)" font-size="11">Trust</text>
              </g>
            </svg>
          </div>

          <div class="concept-details">
            <div class="concept-card">
              <div class="concept-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <path d="M12 6v6l4 2"/>
                </svg>
              </div>
              <div class="concept-text">
                <h4>Real-Time Verification</h4>
                <p>Chain monitoring shows whether funds remain per block &mdash; live proof of key security.</p>
              </div>
            </div>
            <div class="concept-card">
              <div class="concept-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                  <circle cx="9" cy="7" r="4"/>
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
              </div>
              <div class="concept-text">
                <h4>Permissionless Trust</h4>
                <p>Anyone can increase trust by sending funds to a key they rely on.</p>
              </div>
            </div>
            <div class="concept-card">
              <div class="concept-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                </svg>
              </div>
              <div class="concept-text">
                <h4>Adversarial Assumption</h4>
                <p>If key is compromised, rational attacker drains funds immediately.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Login Required State -->
        <div class="adversarial-login-required" id="adversarial-login-required">
          <div class="login-prompt">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--white-40)" stroke-width="1.5">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
            <p>Login to derive addresses from your keys and check live balances across multiple blockchain networks.</p>
          </div>
        </div>

        <!-- Your Wallet Addresses (shown after login) -->
        <div class="adversarial-balances" id="adversarial-balances" style="display: none;">
          <div class="balances-header">
            <h3 class="card-subtitle">Your Derived Addresses</h3>
            <button id="refresh-balances" class="glass-btn small">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23 4 23 10 17 10"/>
                <polyline points="1 20 1 14 7 14"/>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
              </svg>
              Refresh
            </button>
          </div>
          <p class="balances-intro">These addresses are mathematically derived from your HD wallet keys. Anyone can verify the derivation and send funds to increase trust in your keys.</p>

          <div class="wallet-networks-grid" id="wallet-networks-grid">
            <!-- Bitcoin -->
            <div class="wallet-network-card" id="wallet-btc-card">
              <div class="network-icon btc">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-1.67v-1.89c-1.05-.1-2.07-.45-2.81-.95l.47-1.84c.82.43 1.82.79 2.75.79.82 0 1.42-.29 1.42-.95 0-.63-.52-.97-1.73-1.39-1.73-.6-2.92-1.43-2.92-3.07 0-1.48 1.08-2.64 2.82-2.98V6h1.67v1.69c.82.08 1.59.29 2.22.59l-.43 1.77c-.63-.26-1.43-.55-2.32-.55-.92 0-1.24.38-1.24.83 0 .53.5.87 1.9 1.39 1.92.7 2.76 1.63 2.76 3.17-.01 1.53-1.12 2.72-2.89 3.1z"/>
                </svg>
              </div>
              <div class="network-info">
                <div class="network-name-row">
                  <span class="network-name">Bitcoin</span>
                  <span class="derivation-path">m/44'/0'/0'/0/0</span>
                </div>
                <a href="#" id="wallet-btc-explorer" class="network-address-link" target="_blank" rel="noopener">
                  <code id="wallet-btc-address">--</code>
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                    <polyline points="15 3 21 3 21 9"/>
                    <line x1="10" y1="14" x2="21" y2="3"/>
                  </svg>
                </a>
                <div class="network-balance-row">
                  <span class="balance-value" id="wallet-btc-balance">--</span>
                  <span class="balance-unit">BTC</span>
                </div>
              </div>
            </div>

            <!-- Ethereum -->
            <div class="wallet-network-card" id="wallet-eth-card">
              <div class="network-icon eth">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 1.5l-7 10.8 7 4.2 7-4.2-7-10.8zm0 15.6l-7-4.2 7 9.6 7-9.6-7 4.2z"/>
                </svg>
              </div>
              <div class="network-info">
                <div class="network-name-row">
                  <span class="network-name">Ethereum</span>
                  <span class="derivation-path">m/44'/60'/0'/0/0</span>
                </div>
                <a href="#" id="wallet-eth-explorer" class="network-address-link" target="_blank" rel="noopener">
                  <code id="wallet-eth-address">--</code>
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                    <polyline points="15 3 21 3 21 9"/>
                    <line x1="10" y1="14" x2="21" y2="3"/>
                  </svg>
                </a>
                <div class="network-balance-row">
                  <span class="balance-value" id="wallet-eth-balance">--</span>
                  <span class="balance-unit">ETH</span>
                </div>
              </div>
            </div>

            <!-- Solana -->
            <div class="wallet-network-card" id="wallet-sol-card">
              <div class="network-icon sol">
                <svg width="24" height="24" viewBox="0 0 397.7 311.7" fill="currentColor">
                  <linearGradient id="sol-grad-a" x1="360.88" y1="351.46" x2="141.21" y2="-69.29" gradientTransform="matrix(1 0 0 -1 0 314)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00ffa3"/><stop offset="1" stop-color="#dc1fff"/></linearGradient>
                  <linearGradient id="sol-grad-b" x1="264.83" y1="401.6" x2="45.16" y2="-19.14" gradientTransform="matrix(1 0 0 -1 0 314)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00ffa3"/><stop offset="1" stop-color="#dc1fff"/></linearGradient>
                  <linearGradient id="sol-grad-c" x1="312.55" y1="376.69" x2="92.88" y2="-44.09" gradientTransform="matrix(1 0 0 -1 0 314)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#00ffa3"/><stop offset="1" stop-color="#dc1fff"/></linearGradient>
                  <path fill="url(#sol-grad-a)" d="M64.6 237.9c2.4-2.4 5.7-3.8 9.2-3.8h317.4c5.8 0 8.7 7 4.6 11.1l-62.7 62.7c-2.4 2.4-5.7 3.8-9.2 3.8H6.5c-5.8 0-8.7-7-4.6-11.1l62.7-62.7z"/>
                  <path fill="url(#sol-grad-b)" d="M64.6 3.8C67.1 1.4 70.4 0 73.8 0h317.4c5.8 0 8.7 7 4.6 11.1l-62.7 62.7c-2.4 2.4-5.7 3.8-9.2 3.8H6.5c-5.8 0-8.7-7-4.6-11.1L64.6 3.8z"/>
                  <path fill="url(#sol-grad-c)" d="M333.1 120.1c-2.4-2.4-5.7-3.8-9.2-3.8H6.5c-5.8 0-8.7 7-4.6 11.1l62.7 62.7c2.4 2.4 5.7 3.8 9.2 3.8h317.4c5.8 0 8.7-7 4.6-11.1l-62.7-62.7z"/>
                </svg>
              </div>
              <div class="network-info">
                <div class="network-name-row">
                  <span class="network-name">Solana</span>
                  <span class="derivation-path">m/44'/501'/0'/0'</span>
                </div>
                <a href="#" id="wallet-sol-explorer" class="network-address-link" target="_blank" rel="noopener">
                  <code id="wallet-sol-address">--</code>
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                    <polyline points="15 3 21 3 21 9"/>
                    <line x1="10" y1="14" x2="21" y2="3"/>
                  </svg>
                </a>
                <div class="network-balance-row">
                  <span class="balance-value" id="wallet-sol-balance">--</span>
                  <span class="balance-unit">SOL</span>
                </div>
              </div>
            </div>

            <!-- SUI -->
            <div class="wallet-network-card" id="wallet-sui-card">
              <div class="network-icon sui">
                <svg width="24" height="24" viewBox="0 0 32 32" fill="currentColor">
                  <path d="M21.63 10.26a8.3 8.3 0 0 0-1.45-1.65l-6.6 7.24a.84.84 0 0 1-1.26 0 .89.89 0 0 1 0-1.24l6.45-7.1a8.7 8.7 0 0 0-2.68-1.3 8.6 8.6 0 0 0-5.15.18l7.7 8.46a.89.89 0 0 1 0 1.24.84.84 0 0 1-1.26 0L9.7 8.64A8.6 8.6 0 0 0 7.4 11a8.4 8.4 0 0 0-1.15 6.92 8.5 8.5 0 0 0 4.28 5.5 8.6 8.6 0 0 0 6.94.5 8.5 8.5 0 0 0 5.08-4.72 8.4 8.4 0 0 0-.92-8.94z" fill="#4DA2FF"/>
                  <path d="M16.09 2c-1.89 0-3.75.38-5.49 1.12a14.3 14.3 0 0 0-4.65 3.2 14.1 14.1 0 0 0-3.1 4.73A14 14 0 0 0 1.7 16.5c0 1.92.38 3.82 1.11 5.59a14.2 14.2 0 0 0 3.17 4.74 14.3 14.3 0 0 0 4.73 3.15 14.5 14.5 0 0 0 11.08-.04 14.3 14.3 0 0 0 4.69-3.2 14.1 14.1 0 0 0 3.1-4.73 14 14 0 0 0 1.12-5.49c0-7.77-6.38-14.52-14.61-14.52zm5.54 22.74a10.8 10.8 0 0 1-5.54 1.54c-5.93 0-10.73-4.8-10.73-10.76S10.16 4.74 16.09 4.74c5.93 0 10.73 4.82 10.73 10.78a10.7 10.7 0 0 1-5.19 9.22z" fill="#4DA2FF"/>
                </svg>
              </div>
              <div class="network-info">
                <div class="network-name-row">
                  <span class="network-name">SUI</span>
                  <span class="derivation-path">m/44'/784'/0'/0'/0'</span>
                </div>
                <a href="#" id="wallet-sui-explorer" class="network-address-link" target="_blank" rel="noopener">
                  <code id="wallet-sui-address">--</code>
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                    <polyline points="15 3 21 3 21 9"/>
                    <line x1="10" y1="14" x2="21" y2="3"/>
                  </svg>
                </a>
                <div class="network-balance-row">
                  <span class="balance-value" id="wallet-sui-balance">--</span>
                  <span class="balance-unit">SUI</span>
                </div>
              </div>
            </div>

            <!-- Monad -->
            <div class="wallet-network-card" id="wallet-monad-card">
              <div class="network-icon monad">
                <svg width="24" height="24" viewBox="0 0 200 200" fill="none">
                  <circle cx="100" cy="100" r="100" fill="#836EF9"/>
                  <path d="M100 30c-38.66 0-70 31.34-70 70s31.34 70 70 70 70-31.34 70-70-31.34-70-70-70zm0 120c-27.61 0-50-22.39-50-50s22.39-50 50-50 50 22.39 50 50-22.39 50-50 50z" fill="white"/>
                  <circle cx="100" cy="100" r="25" fill="white"/>
                </svg>
              </div>
              <div class="network-info">
                <div class="network-name-row">
                  <span class="network-name">Monad</span>
                  <span class="derivation-path">m/44'/60'/0'/0/0</span>
                </div>
                <a href="#" id="wallet-monad-explorer" class="network-address-link" target="_blank" rel="noopener">
                  <code id="wallet-monad-address">--</code>
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                    <polyline points="15 3 21 3 21 9"/>
                    <line x1="10" y1="14" x2="21" y2="3"/>
                  </svg>
                </a>
                <div class="network-balance-row">
                  <span class="balance-value" id="wallet-monad-balance">--</span>
                  <span class="balance-unit">MON</span>
                </div>
              </div>
            </div>

            <!-- Cardano -->
            <div class="wallet-network-card" id="wallet-ada-card">
              <div class="network-icon ada">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="12" cy="12" r="10"/>
                  <circle cx="12" cy="12" r="3" fill="var(--black)"/>
                </svg>
              </div>
              <div class="network-info">
                <div class="network-name-row">
                  <span class="network-name">Cardano</span>
                  <span class="derivation-path">m/1852'/1815'/0'/0/0</span>
                </div>
                <a href="#" id="wallet-ada-explorer" class="network-address-link" target="_blank" rel="noopener">
                  <code id="wallet-ada-address">--</code>
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                    <polyline points="15 3 21 3 21 9"/>
                    <line x1="10" y1="14" x2="21" y2="3"/>
                  </svg>
                </a>
                <div class="network-balance-row">
                  <span class="balance-value" id="wallet-ada-balance">--</span>
                  <span class="balance-unit">ADA</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Trust Summary -->
          <div class="trust-summary" id="trust-summary">
            <div class="trust-meter">
              <div class="trust-meter-label">
                <span>Aggregate Security Bond</span>
                <span class="trust-total" id="trust-total-value">$0.00</span>
              </div>
              <div class="trust-meter-bar">
                <div class="trust-meter-fill" id="trust-meter-fill"></div>
              </div>
              <p class="trust-note" id="trust-note">Value at these addresses acts as collateral proving key security.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Keep old elements for backwards compatibility but hidden -->
      <div style="display: none;">
        <span id="alice-sui-address"></span>
        <span id="alice-sui-balance"></span>
        <a id="alice-sui-explorer"></a>
        <span id="alice-monad-address"></span>
        <span id="alice-monad-balance"></span>
        <a id="alice-monad-explorer"></a>
        <span id="bob-sui-address"></span>
        <span id="bob-sui-balance"></span>
        <a id="bob-sui-explorer"></a>
        <span id="bob-monad-address"></span>
        <span id="bob-monad-balance"></span>
        <a id="bob-monad-explorer"></a>
      </div>
    </section>

    <!-- Field Encryption Section - Second, shows field-level detail -->
    <section id="fields-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Field-Level Encryption</h2>
        <p class="section-desc">Generate FlatBuffer records and visualize individual field encryption using Alice/Bob keys</p>
      </div>

      <div class="glass-card">
        <div class="card-controls">
          <select id="schema-select" class="glass-select">
            <option value="monster">Monster Schema</option>
            <option value="weapon">Weapon Schema</option>
            <option value="galaxy">Galaxy Schema</option>
          </select>
          <button id="generate-single" class="glass-btn primary">Generate Record</button>
          <button id="toggle-field-decrypt" class="glass-btn" disabled>Decrypt</button>
        </div>

        <!-- FlatBuffer Header -->
        <div class="fb-header-display" id="fb-header" style="display: none;">
          <h3 class="card-subtitle">Binary Structure</h3>
          <div class="header-grid">
            <div class="header-cell">
              <span class="header-label">Root Offset</span>
              <code class="header-hex" id="root-offset-hex">--</code>
              <span class="header-value" id="root-offset-val">--</span>
            </div>
            <div class="header-cell">
              <span class="header-label">File ID</span>
              <code class="header-hex" id="file-id-hex">--</code>
              <span class="header-value" id="file-id-val">--</span>
            </div>
            <div class="header-cell">
              <span class="header-label">VTable Size</span>
              <code class="header-hex" id="vtable-size-hex">--</code>
              <span class="header-value" id="vtable-size-val">--</span>
            </div>
            <div class="header-cell">
              <span class="header-label">Table Size</span>
              <code class="header-hex" id="table-size-hex">--</code>
              <span class="header-value" id="table-size-val">--</span>
            </div>
          </div>
        </div>

        <!-- Field Table -->
        <div class="field-table-wrap" id="field-table-container" style="display: none;">
          <table class="field-table" id="field-table">
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Offset</th>
                <th>Encrypted</th>
                <th class="decrypt-col">Decrypted</th>
                <th class="decrypt-col">Value</th>
              </tr>
            </thead>
            <tbody id="field-body"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Schema Viewer Section -->
    <section id="schema-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Schema Viewer</h2>
        <p class="section-desc">View FlatBuffers schema (.fbs) and equivalent JSON Schema</p>
      </div>

      <div class="glass-card">
        <div class="card-controls">
          <select id="schema-type-select" class="glass-select">
            <option value="monster">Monster Schema</option>
            <option value="weapon">Weapon Schema</option>
            <option value="galaxy">Galaxy Schema</option>
          </select>
        </div>

        <div class="schema-grid">
          <div class="schema-panel">
            <div class="schema-header">
              <h4>.fbs Schema</h4>
              <button id="copy-fbs" class="glass-btn small">Copy</button>
            </div>
            <pre id="fbs-content" class="code-block fbs"></pre>
          </div>
          <div class="schema-panel">
            <div class="schema-header">
              <h4>JSON Schema</h4>
              <button id="copy-json-schema" class="glass-btn small">Copy</button>
            </div>
            <pre id="json-schema-content" class="code-block json"></pre>
          </div>
        </div>
      </div>

      <!-- JSON <-> FlatBuffer Conversion -->
      <div class="glass-card">
        <h3 class="card-subtitle">Convert JSON &harr; FlatBuffer</h3>
        <div class="card-controls">
          <select id="convert-schema-select" class="glass-select">
            <option value="monster">Monster</option>
            <option value="weapon">Weapon</option>
            <option value="galaxy">Galaxy</option>
          </select>
        </div>

        <div class="conversion-grid">
          <div class="conversion-panel">
            <h5>JSON Input</h5>
            <textarea id="json-input" class="code-input" placeholder='{"name": "Orc", "hp": 100, "mana": 50}'></textarea>
            <button id="json-to-fb" class="glass-btn primary">Convert to FlatBuffer &rarr;</button>
          </div>
          <div class="conversion-panel">
            <h5>Hex Input (FlatBuffer)</h5>
            <textarea id="fb-hex-input" class="code-input" placeholder="0C 00 00 00 4D 4F 4E 53 ..."></textarea>
            <button id="fb-to-json" class="glass-btn primary">&larr; Convert to JSON</button>
          </div>
        </div>

        <div id="conversion-result" class="conversion-result" style="display: none;">
          <div class="result-section">
            <h5>FlatBuffer Output <span id="fb-output-size" class="size-badge"></span></h5>
            <pre id="fb-output" class="code-block hex"></pre>
          </div>
          <div class="result-section">
            <h5>JSON Output</h5>
            <pre id="json-output" class="code-block json"></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- Streaming Section -->
    <section id="streaming-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Streaming Dispatcher</h2>
        <p class="section-desc">Route mixed FlatBuffer messages to queues by type</p>
      </div>

      <!-- Explanation Section -->
      <div class="glass-card streaming-explainer">
        <div class="explainer-header">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
          </svg>
          <h3>How Streaming Works</h3>
        </div>
        <div class="explainer-content">
          <div class="explainer-columns">
            <div class="explainer-column">
              <h4>Message Flow</h4>
              <p>FlatBuffers are self-describing binary messages with a 4-byte type identifier prefix. The streaming dispatcher reads this identifier and routes each message to the appropriate queue based on its type.</p>
              <div class="explainer-code">
                <code>[TYPE_ID:4bytes][SIZE:4bytes][FLATBUFFER:N bytes]</code>
              </div>
            </div>
            <div class="explainer-column">
              <h4>Message Queues</h4>
              <p>Each message type has a dedicated queue with a fixed capacity. When full, oldest messages are overwritten (FIFO). This enables constant-memory streaming for high-throughput scenarios without allocations.</p>
              <ul class="explainer-list">
                <li><strong>O(1)</strong> insertion and removal</li>
                <li><strong>Zero allocation</strong> after initialization</li>
                <li><strong>Lock-free</strong> single-producer design</li>
              </ul>
            </div>
            <div class="explainer-column">
              <h4>Use Cases</h4>
              <ul class="explainer-list">
                <li><strong>Telemetry</strong> - Route sensor data by device type</li>
                <li><strong>Gaming</strong> - Separate entity updates from events</li>
                <li><strong>Finance</strong> - Dispatch orders, trades, and quotes</li>
                <li><strong>IoT</strong> - Process heterogeneous device streams</li>
              </ul>
            </div>
          </div>
          <div class="explainer-diagram">
            <svg viewBox="0 0 600 120" class="stream-diagram">
              <!-- Input stream -->
              <g class="stream-input">
                <rect x="10" y="40" width="80" height="40" rx="4" fill="var(--white-10)" stroke="var(--glass-border)"/>
                <text x="50" y="65" text-anchor="middle" fill="var(--white-80)" font-size="12">Mixed Stream</text>
              </g>
              <!-- Arrow to dispatcher -->
              <path d="M95 60 L140 60" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <!-- Dispatcher -->
              <g class="stream-dispatcher">
                <rect x="145" y="30" width="100" height="60" rx="4" fill="var(--primary)" fill-opacity="0.2" stroke="var(--primary)"/>
                <text x="195" y="55" text-anchor="middle" fill="var(--white)" font-size="11">Dispatcher</text>
                <text x="195" y="70" text-anchor="middle" fill="var(--white-60)" font-size="9">Read Type ID</text>
              </g>
              <!-- Arrows to buffers -->
              <path d="M250 45 L300 25" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <path d="M250 60 L300 60" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <path d="M250 75 L300 95" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <!-- Message queues -->
              <g class="queue-viz monster">
                <rect x="305" y="10" width="120" height="30" rx="4" fill="rgba(239, 68, 68, 0.2)" stroke="rgb(239, 68, 68)"/>
                <text x="365" y="30" text-anchor="middle" fill="var(--white-80)" font-size="10">Monster Queue</text>
              </g>
              <g class="queue-viz weapon">
                <rect x="305" y="45" width="120" height="30" rx="4" fill="rgba(59, 130, 246, 0.2)" stroke="rgb(59, 130, 246)"/>
                <text x="365" y="65" text-anchor="middle" fill="var(--white-80)" font-size="10">Weapon Queue</text>
              </g>
              <g class="queue-viz galaxy">
                <rect x="305" y="80" width="120" height="30" rx="4" fill="rgba(168, 85, 247, 0.2)" stroke="rgb(168, 85, 247)"/>
                <text x="365" y="100" text-anchor="middle" fill="var(--white-80)" font-size="10">Galaxy Queue</text>
              </g>
              <!-- Arrows to consumers -->
              <path d="M430 25 L480 25" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <path d="M430 60 L480 60" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <path d="M430 95 L480 95" stroke="var(--white-40)" stroke-width="2" marker-end="url(#arrowhead)"/>
              <!-- Consumers -->
              <g class="stream-consumers">
                <rect x="485" y="10" width="100" height="100" rx="4" fill="var(--white-05)" stroke="var(--glass-border)"/>
                <text x="535" y="35" text-anchor="middle" fill="var(--white-80)" font-size="10">Consumers</text>
                <text x="535" y="55" text-anchor="middle" fill="var(--white-60)" font-size="9">Process by type</text>
                <text x="535" y="70" text-anchor="middle" fill="var(--white-60)" font-size="9">at own pace</text>
              </g>
              <!-- Arrowhead marker -->
              <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                  <polygon points="0 0, 10 3.5, 0 7" fill="var(--white-40)"/>
                </marker>
              </defs>
            </svg>
          </div>
        </div>
      </div>

      <!-- API Documentation -->
      <div class="glass-card streaming-api-docs">
        <h3 class="card-subtitle">API Reference</h3>

        <!-- Wire Format -->
        <div class="api-section">
          <h4>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
              <line x1="8" y1="21" x2="16" y2="21"/>
              <line x1="12" y1="17" x2="12" y2="21"/>
            </svg>
            Wire Format
          </h4>
          <div class="wire-format">
            <div class="wire-format-diagram">
              <div class="wire-segment size">
                <div class="wire-segment-box">SIZE</div>
                <div class="wire-segment-label">4 bytes (LE)</div>
              </div>
              <div class="wire-segment fileid">
                <div class="wire-segment-box">FILE_ID</div>
                <div class="wire-segment-label">4 bytes</div>
              </div>
              <div class="wire-segment data">
                <div class="wire-segment-box">FLATBUFFER DATA</div>
                <div class="wire-segment-label">SIZE - 4 bytes</div>
              </div>
            </div>
            <p class="wire-format-desc">
              Each message is size-prefixed (little-endian) followed by a 4-byte file identifier for routing, then the FlatBuffer payload.
            </p>
          </div>
        </div>

        <!-- Memory Layout -->
        <div class="api-section">
          <h4>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <line x1="3" y1="9" x2="21" y2="9"/>
              <line x1="9" y1="21" x2="9" y2="9"/>
            </svg>
            Memory Layout
          </h4>
          <div class="memory-layout">
            <p class="memory-desc">Messages are stored in contiguous ring buffers in WASM linear memory. Each registered type gets its own buffer:</p>
            <table class="memory-table">
              <thead>
                <tr>
                  <th>Component</th>
                  <th>Location</th>
                  <th>Access Method</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Ring Buffer Base</td>
                  <td><code>bufferPtr</code> from registration</td>
                  <td><code>getTypeInfo(fileId).bufferPtr</code></td>
                </tr>
                <tr>
                  <td>Message N</td>
                  <td><code>bufferPtr + (N * messageSize)</code></td>
                  <td><code>getMessage(fileId, N)</code></td>
                </tr>
                <tr>
                  <td>Latest Message</td>
                  <td><code>bufferPtr + (head * messageSize)</code></td>
                  <td><code>getLatestMessage(fileId)</code></td>
                </tr>
                <tr>
                  <td>Raw Memory View</td>
                  <td><code>HEAPU8.subarray(ptr, ptr + size)</code></td>
                  <td><code>new Uint8Array(wasm.HEAPU8.buffer, ptr, size)</code></td>
                </tr>
              </tbody>
            </table>
            <div class="memory-note">
              <strong>Zero-Copy Access:</strong> <code>getMessage()</code> returns a <code>Uint8Array</code> view directly into WASM memory - no data is copied.
              This view is valid until the next <code>pushBytes()</code> call that overwrites the ring buffer slot.
            </div>
          </div>
        </div>

        <!-- Initialization Example -->
        <div class="api-section">
          <h4>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="4 17 10 11 4 5"/>
              <line x1="12" y1="19" x2="20" y2="19"/>
            </svg>
            Initialization
          </h4>
          <div class="code-example">
            <div class="example-tabs extended" data-example-group="streaming-init">
              <button class="example-tab active" data-lang="cpp">C++</button>
              <button class="example-tab" data-lang="ts">TypeScript</button>
              <button class="example-tab" data-lang="js">JavaScript</button>
              <button class="example-tab" data-lang="rust">Rust</button>
              <button class="example-tab" data-lang="go">Go</button>
              <button class="example-tab" data-lang="python">Python</button>
            </div>
            <pre id="streaming-init-code" class="code-display"></pre>
          </div>
        </div>

        <!-- Streaming Example -->
        <div class="api-section">
          <h4>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
            </svg>
            Streaming Data
          </h4>
          <div class="code-example">
            <div class="example-tabs extended" data-example-group="streaming-push">
              <button class="example-tab active" data-lang="cpp">C++</button>
              <button class="example-tab" data-lang="ts">TypeScript</button>
              <button class="example-tab" data-lang="js">JavaScript</button>
              <button class="example-tab" data-lang="rust">Rust</button>
              <button class="example-tab" data-lang="go">Go</button>
              <button class="example-tab" data-lang="python">Python</button>
            </div>
            <pre id="streaming-push-code" class="code-display"></pre>
          </div>
        </div>

        <!-- Access Patterns Example -->
        <div class="api-section">
          <h4>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            Access Patterns
          </h4>
          <div class="code-example">
            <div class="example-tabs extended" data-example-group="streaming-access">
              <button class="example-tab active" data-lang="cpp">C++</button>
              <button class="example-tab" data-lang="ts">TypeScript</button>
              <button class="example-tab" data-lang="js">JavaScript</button>
              <button class="example-tab" data-lang="rust">Rust</button>
              <button class="example-tab" data-lang="go">Go</button>
              <button class="example-tab" data-lang="python">Python</button>
            </div>
            <pre id="streaming-access-code" class="code-display"></pre>
          </div>
        </div>
      </div>

      <!-- Interactive Demo -->
      <div class="glass-card">
        <h3 class="card-subtitle">Interactive Demo</h3>
        <div class="streaming-grid">
          <div class="stream-config">
            <label>Monster (MONS)</label>
            <input type="number" id="stream-monster-count" class="glass-input" value="1000" min="0" max="100000" step="100">
          </div>
          <div class="stream-config">
            <label>Weapon (WEAP)</label>
            <input type="number" id="stream-weapon-count" class="glass-input" value="500" min="0" max="100000" step="100">
          </div>
          <div class="stream-config">
            <label>Galaxy (GALX)</label>
            <input type="number" id="stream-galaxy-count" class="glass-input" value="200" min="0" max="100000" step="100">
          </div>
          <div class="stream-config">
            <label>Batch Size</label>
            <input type="number" id="stream-batch-size" class="glass-input" value="100" min="1" max="1000">
          </div>
          <div class="stream-config">
            <label>Delay (ms)</label>
            <input type="number" id="stream-delay" class="glass-input" value="10" min="0" max="1000">
          </div>
        </div>

        <div class="card-controls">
          <button id="start-streaming" class="glass-btn primary">Start Stream</button>
          <button id="stop-streaming" class="glass-btn" disabled>Stop</button>
          <button id="clear-streaming" class="glass-btn">Reset</button>
        </div>

        <!-- Progress -->
        <div class="stream-progress" id="stream-progress" style="display: none;">
          <div class="progress-track">
            <div class="progress-fill" id="stream-progress-fill"></div>
          </div>
          <div class="progress-label">
            <span id="stream-processed">0</span> / <span id="stream-total">0</span> messages
            <span class="progress-bytes">(<span id="stream-bytes">0 KB</span>)</span>
          </div>
        </div>

        <!-- Queue Stats -->
        <div class="queue-stats-grid" id="queue-stats">
          <div class="queue-card monster" data-type="MONS">
            <div class="queue-header">
              <span class="queue-dot"></span>
              <span class="queue-title">Monster (MONS)</span>
            </div>
            <div class="queue-bar">
              <div class="queue-fill" id="queue-fill-MONS"></div>
            </div>
            <div class="queue-numbers">
              <span><span id="queue-count-MONS">0</span> / <span id="queue-capacity-MONS">1000</span></span>
              <span class="queue-total">Total: <span id="queue-total-MONS">0</span></span>
            </div>
          </div>
          <div class="queue-card weapon" data-type="WEAP">
            <div class="queue-header">
              <span class="queue-dot"></span>
              <span class="queue-title">Weapon (WEAP)</span>
            </div>
            <div class="queue-bar">
              <div class="queue-fill" id="queue-fill-WEAP"></div>
            </div>
            <div class="queue-numbers">
              <span><span id="queue-count-WEAP">0</span> / <span id="queue-capacity-WEAP">500</span></span>
              <span class="queue-total">Total: <span id="queue-total-WEAP">0</span></span>
            </div>
          </div>
          <div class="queue-card galaxy" data-type="GALX">
            <div class="queue-header">
              <span class="queue-dot"></span>
              <span class="queue-title">Galaxy (GALX)</span>
            </div>
            <div class="queue-bar">
              <div class="queue-fill" id="queue-fill-GALX"></div>
            </div>
            <div class="queue-numbers">
              <span><span id="queue-count-GALX">0</span> / <span id="queue-capacity-GALX">200</span></span>
              <span class="queue-total">Total: <span id="queue-total-GALX">0</span></span>
            </div>
          </div>
        </div>

        <!-- Completion with Hex Explorer -->
        <div class="completion-card" id="completion-stats" style="display: none;">
          <div class="completion-split">
            <!-- Stats Side -->
            <div class="completion-stats-side">
              <h4>Stream Complete</h4>
              <div class="completion-grid">
                <span>Messages</span><span id="complete-messages">--</span>
                <span>Bytes</span><span id="complete-bytes">--</span>
                <span>Time</span><span id="complete-time">--</span>
                <span>Throughput</span><span id="complete-throughput">--</span>
              </div>
              <div class="wire-format-note">
                <strong>Wire Format:</strong> Not encrypted - raw binary
              </div>
            </div>
            <!-- Hex Explorer Side -->
            <div class="hex-explorer-side">
              <div class="hex-explorer-header">
                <h4>Message Hex Explorer</h4>
                <div class="hex-type-selector">
                  <button class="hex-type-btn active" data-type="MONS">MONS</button>
                  <button class="hex-type-btn" data-type="WEAP">WEAP</button>
                  <button class="hex-type-btn" data-type="GALX">GALX</button>
                </div>
              </div>
              <div class="hex-table-container">
                <table class="hex-table" id="hex-table">
                  <thead>
                    <tr>
                      <th class="hex-offset">Offset</th>
                      <th class="hex-bytes">Hex Data</th>
                      <th class="hex-ascii">ASCII</th>
                    </tr>
                  </thead>
                  <tbody id="hex-table-body">
                    <tr><td colspan="3" class="hex-empty">Run stream to view message data</td></tr>
                  </tbody>
                </table>
              </div>
              <div class="hex-pagination">
                <button class="glass-btn small" id="hex-prev" disabled>&lt; Prev</button>
                <span class="hex-page-info">Msg <span id="hex-current-msg">0</span> / <span id="hex-total-msgs">0</span></span>
                <button class="glass-btn small" id="hex-next" disabled>Next &gt;</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Identity Section -->
    <section id="identity-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Cryptographic Identity</h2>
        <p class="section-desc">Generate a vCard with your public keys for secure sharing</p>
      </div>

      <div class="glass-card">
        <div class="identity-form">
          <div class="form-row">
            <div class="glass-input-group">
              <label>Prefix</label>
              <input type="text" id="vcard-prefix" class="glass-input" placeholder="Dr.">
            </div>
            <div class="glass-input-group">
              <label>First Name</label>
              <input type="text" id="vcard-firstname" class="glass-input" placeholder="John">
            </div>
            <div class="glass-input-group">
              <label>Middle Name</label>
              <input type="text" id="vcard-middlename" class="glass-input" placeholder="Michael">
            </div>
            <div class="glass-input-group">
              <label>Last Name</label>
              <input type="text" id="vcard-lastname" class="glass-input" placeholder="Doe">
            </div>
            <div class="glass-input-group">
              <label>Suffix</label>
              <input type="text" id="vcard-suffix" class="glass-input" placeholder="Jr.">
            </div>
          </div>
          <div class="form-row">
            <div class="glass-input-group">
              <label>Email</label>
              <input type="email" id="vcard-email" class="glass-input" placeholder="john@example.com">
            </div>
            <div class="glass-input-group">
              <label>Organization</label>
              <input type="text" id="vcard-org" class="glass-input" placeholder="Company Name">
            </div>
            <div class="glass-input-group">
              <label>Job Title</label>
              <input type="text" id="vcard-title" class="glass-input" placeholder="Software Engineer">
            </div>
          </div>
          <label class="checkbox-label">
            <input type="checkbox" id="include-keys" checked>
            <span>Include cryptographic public keys</span>
          </label>
        </div>

        <button id="generate-vcard" class="glass-btn primary">Generate vCard</button>

        <div id="vcard-result" class="vcard-result" style="display: none;">
          <div class="qr-container">
            <canvas id="qr-code"></canvas>
          </div>
          <div class="vcard-actions">
            <button id="download-vcard" class="glass-btn">Download .vcf</button>
            <button id="copy-vcard" class="glass-btn">Copy</button>
          </div>
          <details class="vcard-details">
            <summary>View Raw vCard</summary>
            <pre id="vcard-preview"></pre>
          </details>
        </div>
      </div>
    </section>

    <!-- Studio Section -->
    <section id="studio-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">FlatBuffer Studio</h2>
        <p class="section-desc">Create schemas, generate code, and build FlatBuffers in the browser <span id="flatc-version" class="flatc-version"></span></p>
      </div>

      <div class="studio-notice" id="studio-codegen-notice" style="display: none;">
        <span class="notice-icon">i</span>
        <span>Generated code does not include encryption. For encryption support, see <a href="#runtimes" data-tab="runtimes">WASM Runtimes</a>.</span>
      </div>

      <div class="studio-container">
        <!-- Studio Tabs -->
        <div class="studio-tabs">
          <button class="studio-tab active" data-studio-tab="schema-editor">Schema Editor</button>
          <button class="studio-tab" data-studio-tab="schema-builder">Schema Builder</button>
          <button class="studio-tab" data-studio-tab="code-gen">Code Generator</button>
          <button class="studio-tab" data-studio-tab="data-builder">Data Builder</button>
          <button class="studio-tab" data-studio-tab="downloads">Downloads</button>
        </div>

        <!-- Schema Editor Panel -->
        <div id="studio-schema-editor" class="studio-panel active">
          <div class="schema-editor-layout">
            <!-- Left: File Tree -->
            <div class="schema-file-tree">
              <div class="pane-header">
                <h4>Files</h4>
                <div class="pane-actions">
                  <button id="schema-new-file" class="glass-btn small icon-btn" title="New File">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                      <polyline points="14 2 14 8 20 8"></polyline>
                      <line x1="12" y1="18" x2="12" y2="12"></line>
                      <line x1="9" y1="15" x2="15" y2="15"></line>
                    </svg>
                  </button>
                  <button id="schema-new-folder" class="glass-btn small icon-btn" title="New Folder">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                      <line x1="12" y1="11" x2="12" y2="17"></line>
                      <line x1="9" y1="14" x2="15" y2="14"></line>
                    </svg>
                  </button>
                  <label class="glass-btn small icon-btn" title="Upload Files">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <input type="file" id="studio-upload-schema" accept=".fbs,.json" multiple hidden>
                  </label>
                </div>
              </div>
              <div class="file-tree-body" id="schema-file-tree">
                <div class="empty-state small">No files yet</div>
              </div>
              <div class="pane-footer small">
                <button id="studio-load-sample" class="glass-btn small full-width">Load Sample Project</button>
              </div>
            </div>

            <!-- Center: Editor -->
            <div class="schema-editor-main">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4 id="schema-editor-title">Schema Definition</h4>
                  <div class="pane-actions">
                    <span id="schema-current-file" class="current-file-indicator"></span>
                  </div>
                </div>
                <div class="pane-body code-editor-body">
                  <textarea id="studio-schema-input" class="code-textarea" spellcheck="false" placeholder="// Select or create a file to begin editing..."></textarea>
                </div>
                <div class="pane-footer">
                  <button id="studio-parse-schema" class="glass-btn primary">Parse All &amp; Validate</button>
                  <span id="studio-schema-status" class="status-text"></span>
                </div>
              </div>
            </div>

            <!-- Right: Parsed Structure -->
            <div class="schema-parsed-pane">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4>Parsed Structure</h4>
                </div>
                <div class="pane-body">
                  <div id="studio-parsed-view" class="parsed-view">
                    <div class="empty-state">Parse schemas to see structure</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Schema Builder Panel -->
        <div id="studio-schema-builder" class="studio-panel">
          <div class="schema-builder-layout">
            <!-- Left: Item List -->
            <div class="schema-builder-sidebar">
              <div class="builder-config">
                <div class="glass-input-group">
                  <label>Namespace</label>
                  <input type="text" id="builder-namespace" class="glass-input" placeholder="MyGame.Sample">
                </div>
                <div class="glass-input-group" id="builder-root-type-group" style="display: none;">
                  <label>Root Type</label>
                  <select id="builder-root-type" class="glass-select">
                    <option value="">Select root type...</option>
                  </select>
                </div>
                <div class="builder-config-row">
                  <div class="glass-input-group">
                    <label>File ID <span class="label-hint">(4 chars)</span></label>
                    <input type="text" id="builder-file-identifier" class="glass-input" placeholder="XXXX" maxlength="4" style="width: 70px; font-family: monospace;">
                  </div>
                  <div class="glass-input-group">
                    <label>Extension</label>
                    <input type="text" id="builder-file-extension" class="glass-input" placeholder="bin" style="width: 70px;">
                  </div>
                </div>
                <details class="builder-advanced">
                  <summary>Advanced Options</summary>
                  <div class="glass-input-group">
                    <label>Includes <span class="label-hint">(one per line)</span></label>
                    <textarea id="builder-includes" class="glass-input" placeholder="other.fbs&#10;common/types.fbs" rows="2"></textarea>
                  </div>
                  <div class="glass-input-group">
                    <label>Custom Attributes <span class="label-hint">(one per line)</span></label>
                    <textarea id="builder-attributes" class="glass-input" placeholder="my_custom_attr&#10;another_attr" rows="2"></textarea>
                  </div>
                </details>
              </div>
              <div class="builder-add-section">
                <div class="builder-add-dropdown">
                  <button id="builder-add-btn" class="glass-btn small">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Item
                  </button>
                  <div id="builder-add-menu" class="builder-add-menu" style="display: none;">
                    <button data-item-type="table">Table</button>
                    <button data-item-type="enum">Enum</button>
                    <button data-item-type="struct">Struct</button>
                    <button data-item-type="union">Union</button>
                    <button data-item-type="rpc">RPC Service</button>
                  </div>
                </div>
              </div>
              <div id="builder-item-list" class="builder-item-list">
                <div class="empty-state">Add a table, enum, or struct to begin</div>
              </div>
            </div>

            <!-- Center: Item Editor -->
            <div class="schema-builder-editor">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4 id="builder-editor-title">Item Editor</h4>
                </div>
                <div class="pane-body">
                  <div id="builder-editor-content" class="builder-editor-content">
                    <div class="empty-state">Select an item to edit</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right: Preview -->
            <div class="schema-builder-preview">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4>Preview</h4>
                  <div class="pane-actions">
                    <div class="builder-preview-toggle">
                      <button id="builder-preview-fbs" class="toggle-btn active">FBS</button>
                      <button id="builder-preview-json" class="toggle-btn">JSON Schema</button>
                    </div>
                  </div>
                </div>
                <div class="pane-body">
                  <pre id="builder-preview-code" class="builder-preview-code">// Schema preview will appear here...</pre>
                </div>
                <div class="pane-footer">
                  <span id="builder-validation-status" class="builder-validation-status"></span>
                  <button id="builder-copy-code" class="glass-btn small">Copy</button>
                  <button id="builder-export-editor" class="glass-btn small primary">Export to Editor</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Code Generator Panel -->
        <div id="studio-code-gen" class="studio-panel">
          <div class="code-gen-layout">
            <!-- Left: Options -->
            <div class="code-gen-options">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4>Options</h4>
                </div>
                <div class="pane-body">
                  <div class="codegen-options-content">
                    <div class="glass-input-group">
                      <label>Target Language</label>
                      <select id="studio-codegen-lang" class="glass-select">
                        <option value="ts">TypeScript</option>
                        <option value="python">Python</option>
                        <option value="cpp">C++</option>
                        <option value="rust">Rust</option>
                        <option value="go">Go</option>
                        <option value="java">Java</option>
                        <option value="csharp">C#</option>
                        <option value="kotlin">Kotlin</option>
                        <option value="swift">Swift</option>
                        <option value="jsonschema">JSON Schema</option>
                      </select>
                    </div>
                    <div class="codegen-checkboxes">
                      <label class="checkbox-label">
                        <input type="checkbox" id="studio-opt-mutable" checked>
                        <span>Mutable APIs</span>
                      </label>
                      <label class="checkbox-label">
                        <input type="checkbox" id="studio-opt-object-api" checked>
                        <span>Object API</span>
                      </label>
                    </div>
                    <button id="studio-generate-code" class="glass-btn primary full-width">Generate Code</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Center: File Tree -->
            <div class="code-gen-files">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4>Generated Files</h4>
                  <span id="codegen-file-count" class="file-count-badge"></span>
                </div>
                <div class="pane-body">
                  <div id="codegen-file-tree" class="codegen-file-tree">
                    <div class="empty-state small">Generate code to see files</div>
                  </div>
                </div>
                <div class="pane-footer">
                  <button id="studio-download-code" class="glass-btn small full-width">Download All</button>
                </div>
              </div>
            </div>

            <!-- Right: Code View -->
            <div class="code-gen-content">
              <div class="studio-pane">
                <div class="pane-header">
                  <h4 id="codegen-current-file">Generated Code</h4>
                  <div class="pane-actions">
                    <button id="studio-copy-code" class="glass-btn small">Copy</button>
                  </div>
                </div>
                <div class="pane-body code-view-body">
                  <pre id="studio-generated-code" class="code-display">// Generated code will appear here...</pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Data Builder Panel -->
        <div id="studio-data-builder" class="studio-panel">
          <div class="studio-split three-col">
            <div class="studio-pane">
              <div class="pane-header">
                <h4>Data Entry</h4>
                <div class="mode-toggle">
                  <button class="mode-btn active" data-mode="single">Single</button>
                  <button class="mode-btn" data-mode="bulk">Bulk</button>
                </div>
                <select id="studio-builder-table" class="glass-select compact">
                  <option value="">Select Table</option>
                </select>
              </div>
              <div class="pane-body">
                <!-- Single Mode Form -->
                <div id="studio-builder-form" class="builder-form">
                  <div class="empty-state">Parse a schema and select a table</div>
                </div>
                <!-- Bulk Mode Config -->
                <div id="studio-bulk-config" class="bulk-config" style="display: none;">
                  <div class="bulk-input-group">
                    <label>Record Count</label>
                    <input type="number" id="bulk-record-count" class="glass-input" value="100" min="1" max="10000" step="10">
                  </div>
                  <div class="bulk-encryption-section">
                    <div class="section-header">
                      <h5>Encryption Settings</h5>
                      <label class="checkbox-label">
                        <input type="checkbox" id="bulk-encrypt-enabled" checked>
                        <span>Enable</span>
                      </label>
                    </div>

                    <!-- Recipient Key Selector -->
                    <div class="bulk-input-group">
                      <label>Encrypt For</label>
                      <select id="bulk-key-selector" class="glass-select">
                        <option value="bob">Bob (from HD wallet)</option>
                        <option value="alice">Alice (from HD wallet)</option>
                        <option value="custom">Custom Public Key</option>
                      </select>
                    </div>

                    <!-- Custom Public Key Input (shown when "custom" selected) -->
                    <div class="bulk-input-group" id="bulk-custom-key-group" style="display: none;">
                      <label>Recipient Public Key (hex)</label>
                      <textarea id="bulk-public-key" class="glass-input key-input" rows="2" placeholder="Paste hex-encoded X25519 public key..."></textarea>
                      <span class="key-status" id="bulk-pubkey-status"></span>
                    </div>

                    <!-- Key Verification / Adversarial Security Info -->
                    <div class="bulk-key-verification" id="bulk-key-verification">
                      <div class="verification-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                        </svg>
                        <span>Recipient Key Verification</span>
                      </div>
                      <div class="verification-addresses">
                        <div class="verification-row">
                          <span class="chain-label">BTC</span>
                          <code id="bulk-verify-btc-addr" class="addr-code">--</code>
                          <span class="balance-badge" id="bulk-verify-btc-bal">--</span>
                        </div>
                        <div class="verification-row">
                          <span class="chain-label">ETH</span>
                          <code id="bulk-verify-eth-addr" class="addr-code">--</code>
                          <span class="balance-badge" id="bulk-verify-eth-bal">--</span>
                        </div>
                        <div class="verification-row">
                          <span class="chain-label">SOL</span>
                          <code id="bulk-verify-sol-addr" class="addr-code">--</code>
                          <span class="balance-badge" id="bulk-verify-sol-bal">--</span>
                        </div>
                        <div class="verification-row">
                          <span class="chain-label">SUI</span>
                          <code id="bulk-verify-sui-addr" class="addr-code">--</code>
                          <span class="balance-badge" id="bulk-verify-sui-bal">--</span>
                        </div>
                        <div class="verification-row">
                          <span class="chain-label">Monad</span>
                          <code id="bulk-verify-monad-addr" class="addr-code">--</code>
                          <span class="balance-badge" id="bulk-verify-monad-bal">--</span>
                        </div>
                        <div class="verification-row">
                          <span class="chain-label">ADA</span>
                          <code id="bulk-verify-ada-addr" class="addr-code">--</code>
                          <span class="balance-badge" id="bulk-verify-ada-bal">--</span>
                        </div>
                      </div>
                      <p class="verification-note" id="bulk-verify-note">Select a recipient to verify their key's on-chain presence.</p>
                    </div>

                    <!-- Decryption Key (for testing) -->
                    <details class="decryption-details">
                      <summary>Decryption Settings (for testing)</summary>
                      <div class="bulk-input-group">
                        <label>Decryption Private Key</label>
                        <select id="bulk-decrypt-selector" class="glass-select">
                          <option value="bob">Bob's Private Key</option>
                          <option value="alice">Alice's Private Key</option>
                          <option value="custom">Custom Private Key</option>
                        </select>
                      </div>
                      <div class="bulk-input-group" id="bulk-custom-privkey-group" style="display: none;">
                        <textarea id="bulk-private-key" class="glass-input key-input" rows="2" placeholder="Hex-encoded private key..."></textarea>
                        <span class="key-status" id="bulk-privkey-status"></span>
                      </div>
                    </details>
                  </div>
                </div>
              </div>
              <!-- Single Mode Footer -->
              <div class="pane-footer" id="studio-single-footer">
                <button id="studio-build-buffer" class="glass-btn primary">Build Buffer</button>
                <button id="studio-clear-form" class="glass-btn small">Clear</button>
              </div>
              <!-- Bulk Mode Footer -->
              <div class="pane-footer" id="studio-bulk-footer" style="display: none;">
                <button id="bulk-generate-btn" class="glass-btn primary">Generate</button>
                <button id="bulk-clear-btn" class="glass-btn small">Clear</button>
              </div>
            </div>
            <div class="studio-pane">
              <div class="pane-header">
                <h4>Buffer Output</h4>
                <div class="bulk-hex-nav" id="bulk-hex-nav" style="display: none;">
                  <button id="bulk-hex-prev" class="glass-btn small icon-btn">&lt;</button>
                  <span id="bulk-hex-index">0 / 0</span>
                  <button id="bulk-hex-next" class="glass-btn small icon-btn">&gt;</button>
                </div>
                <label class="checkbox-label" id="single-encrypt-label">
                  <input type="checkbox" id="studio-encrypt-buffer">
                  <span>Encrypt</span>
                </label>
              </div>
              <div class="pane-body">
                <div id="studio-hex-view" class="hex-view">
                  <div class="empty-state">Build a buffer to see output</div>
                </div>
              </div>
              <div class="pane-footer">
                <button id="studio-download-buffer" class="glass-btn small" disabled>Download .bin</button>
                <label class="glass-btn small">
                  Upload .bin
                  <input type="file" id="studio-upload-buffer" accept=".bin,.fb" hidden>
                </label>
              </div>
            </div>
            <!-- Single Mode: Decoded JSON Pane -->
            <div class="studio-pane" id="studio-decoded-pane">
              <div class="pane-header">
                <h4>Decoded JSON</h4>
              </div>
              <div class="pane-body">
                <pre id="studio-decoded-view" class="json-view"><div class="empty-state">Build or upload a buffer</div></pre>
              </div>
            </div>
            <!-- Bulk Mode: Results Pane -->
            <div class="studio-pane" id="studio-bulk-results" style="display: none;">
              <div class="pane-header">
                <h4>Bulk Results</h4>
                <span id="bulk-stats" class="stats-badge"></span>
              </div>
              <div class="pane-body">
                <div id="bulk-results-table" class="bulk-results-wrapper">
                  <div class="empty-state">Generate bulk records to see results</div>
                </div>
              </div>
              <div class="pane-footer">
                <button id="bulk-toggle-decrypt" class="glass-btn small" disabled>Decrypt All</button>
                <button id="bulk-download-all" class="glass-btn small" disabled>Download All</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Downloads Panel -->
        <div id="studio-downloads" class="studio-panel">
          <div class="downloads-grid">
            <div class="download-card">
              <div class="download-icon ts">TS</div>
              <h4>TypeScript / JavaScript</h4>
              <p>NPM package with full TypeScript definitions</p>
              <code class="install-cmd">npm install flatbuffers</code>
              <a href="https://www.npmjs.com/package/flatbuffers" target="_blank" class="glass-btn small">NPM</a>
            </div>
            <div class="download-card">
              <div class="download-icon py">PY</div>
              <h4>Python</h4>
              <p>PyPI package for Python 3.x</p>
              <code class="install-cmd">pip install flatbuffers</code>
              <a href="https://pypi.org/project/flatbuffers/" target="_blank" class="glass-btn small">PyPI</a>
            </div>
            <div class="download-card">
              <div class="download-icon rs">RS</div>
              <h4>Rust</h4>
              <p>Cargo crate with no_std support</p>
              <code class="install-cmd">cargo add flatbuffers</code>
              <a href="https://crates.io/crates/flatbuffers" target="_blank" class="glass-btn small">Crates.io</a>
            </div>
            <div class="download-card">
              <div class="download-icon go">GO</div>
              <h4>Go</h4>
              <p>Go module with generics support</p>
              <code class="install-cmd">go get github.com/google/flatbuffers/go</code>
              <a href="https://pkg.go.dev/github.com/google/flatbuffers/go" target="_blank" class="glass-btn small">Pkg.dev</a>
            </div>
            <div class="download-card">
              <div class="download-icon cpp">C++</div>
              <h4>C++</h4>
              <p>Header-only library, C++11 compatible</p>
              <code class="install-cmd">#include "flatbuffers/flatbuffers.h"</code>
              <a href="https://github.com/google/flatbuffers/tree/master/include" target="_blank" class="glass-btn small">GitHub</a>
            </div>
            <div class="download-card">
              <div class="download-icon cs">C#</div>
              <h4>C# / .NET</h4>
              <p>NuGet package for .NET Standard 2.0+</p>
              <code class="install-cmd">dotnet add package FlatBuffers</code>
              <a href="https://www.nuget.org/packages/Google.FlatBuffers" target="_blank" class="glass-btn small">NuGet</a>
            </div>
            <div class="download-card">
              <div class="download-icon java">JV</div>
              <h4>Java</h4>
              <p>Maven Central artifact</p>
              <code class="install-cmd">com.google.flatbuffers:flatbuffers-java</code>
              <a href="https://central.sonatype.com/artifact/com.google.flatbuffers/flatbuffers-java" target="_blank" class="glass-btn small">Maven</a>
            </div>
            <div class="download-card">
              <div class="download-icon swift">SW</div>
              <h4>Swift</h4>
              <p>Swift Package Manager</p>
              <code class="install-cmd">.package(url: "flatbuffers.git")</code>
              <a href="https://github.com/google/flatbuffers/tree/master/swift" target="_blank" class="glass-btn small">GitHub</a>
            </div>
            <div class="download-card featured">
              <div class="download-icon wasm">WA</div>
              <h4>WASM Compiler (flatc)</h4>
              <p>Run flatc in the browser or Node.js</p>
              <div class="download-actions">
                <button id="studio-download-flatc-wasm" class="glass-btn primary small">flatc.wasm</button>
                <button id="studio-download-flatc-js" class="glass-btn small">flatc.mjs</button>
              </div>
            </div>
            <div class="download-card featured">
              <div class="download-icon enc">EN</div>
              <h4>Encryption Module (WASM)</h4>
              <p>AES-256, X25519, secp256k1, P-256, Ed25519</p>
              <div class="download-actions">
                <button id="studio-download-enc-wasm" class="glass-btn primary small">encryption.wasm</button>
                <button id="studio-download-enc-js" class="glass-btn small">encryption.mjs</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Aligned Binary Format Section -->
    <section id="aligned-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">Aligned Binary Format</h2>
        <p class="section-desc">Zero-overhead, fixed-size structs from FlatBuffers schemas for WASM/native interop</p>
      </div>

      <!-- Introduction Card -->
      <div class="glass-card">
        <h3 class="card-subtitle">Why Aligned Format?</h3>
        <div class="overview-grid">
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>Zero-Copy Access</h4>
              <p>TypedArray views directly into WASM linear memory. No deserialization overhead - just cast and access.</p>
            </div>
          </div>
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <line x1="9" y1="3" x2="9" y2="21"/>
                <line x1="15" y1="3" x2="15" y2="21"/>
                <line x1="3" y1="9" x2="21" y2="9"/>
                <line x1="3" y1="15" x2="21" y2="15"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>Fixed-Size Layout</h4>
              <p>Predictable memory layout with proper alignment. Perfect for arrays of structs in shared memory.</p>
            </div>
          </div>
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>FlatBuffers Schema</h4>
              <p>Use familiar FlatBuffers .fbs syntax. Structs and tables with scalars and fixed-size arrays are supported.</p>
            </div>
          </div>
          <div class="overview-item">
            <div class="overview-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="16 18 22 12 16 6"/>
                <polyline points="8 6 2 12 8 18"/>
              </svg>
            </div>
            <div class="overview-content">
              <h4>Multi-Language Output</h4>
              <p>Generate C++ headers, TypeScript classes, and JavaScript modules from a single schema definition.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Aligned Code Generator -->
      <div class="glass-card">
        <h3 class="card-subtitle">Code Generator</h3>
        <p class="card-desc">Paste a FlatBuffers schema below to generate aligned binary format code:</p>

        <div class="aligned-layout">
          <!-- Left: Schema Input -->
          <div class="aligned-input-pane">
            <div class="studio-pane">
              <div class="pane-header">
                <h4>Schema (FBS)</h4>
              </div>
              <div class="pane-body code-editor-body">
                <textarea id="aligned-schema-input" class="code-textarea" spellcheck="false" placeholder="// Example schema
namespace MyGame;

struct Vec3 {
  x:float;
  y:float;
  z:float;
}

table Entity {
  position:Vec3;
  health:int;
  mana:int;
  name:string;  // Fixed-length if string length is set
}"></textarea>
              </div>
              <div class="pane-footer">
                <div class="aligned-options">
                  <div class="glass-input-group inline">
                    <label for="aligned-string-length">String Length</label>
                    <input type="number" id="aligned-string-length" class="glass-input small" value="0" min="0" max="65535" placeholder="0" title="Max string length (0 = disabled)">
                  </div>
                </div>
                <button id="aligned-generate" class="glass-btn primary">Generate Code</button>
              </div>
            </div>
          </div>

          <!-- Right: Generated Code -->
          <div class="aligned-output-pane">
            <div class="studio-pane">
              <div class="pane-header">
                <h4>Generated Code</h4>
                <div class="pane-actions">
                  <div class="aligned-lang-toggle">
                    <button class="toggle-btn active" data-aligned-lang="cpp">C++</button>
                    <button class="toggle-btn" data-aligned-lang="ts">TypeScript</button>
                    <button class="toggle-btn" data-aligned-lang="js">JavaScript</button>
                  </div>
                </div>
              </div>
              <div class="pane-body code-view-body">
                <pre id="aligned-output" class="code-display">// Generated code will appear here...</pre>
              </div>
              <div class="pane-footer">
                <span id="aligned-status" class="status-text"></span>
                <button id="aligned-copy" class="glass-btn small">Copy</button>
                <button id="aligned-download" class="glass-btn small">Download</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Features & Limitations -->
      <div class="glass-card">
        <h3 class="card-subtitle">Supported Features</h3>
        <div class="aligned-features">
          <div class="feature-col supported">
            <h4><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg> Supported</h4>
            <ul>
              <li>Scalars: bool, byte, ubyte, short, ushort, int, uint, long, ulong, float, double</li>
              <li>Fixed-size arrays: <code>[float:3]</code>, <code>[int:16]</code></li>
              <li>Hex array sizes: <code>[ubyte:0x100]</code> (256 bytes)</li>
              <li>Nested structs (inlined by value)</li>
              <li>Enums with explicit base type</li>
              <li>Fixed-length strings (set String Length &gt; 0)</li>
            </ul>
          </div>
          <div class="feature-col unsupported">
            <h4><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg> Not Supported</h4>
            <ul>
              <li>Variable-length strings (without String Length)</li>
              <li>Variable-length vectors</li>
              <li>Unions</li>
              <li>Tables with optional fields (use structs)</li>
            </ul>
          </div>
        </div>
        <div class="compliance-note" style="margin-top: 1rem;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4M12 8h.01"/>
          </svg>
          <span><strong>String Length:</strong> When set &gt; 0, string fields become fixed-size char arrays (e.g., 255 = 256 bytes including null terminator). This enables strings in the aligned format while maintaining fixed-size layout.</span>
        </div>
      </div>

      <!-- Usage Example -->
      <div class="glass-card">
        <h3 class="card-subtitle">Usage Example</h3>
        <div class="code-example">
          <div class="example-tabs">
            <button class="example-tab active" data-example="cpp">C++ (WASM)</button>
            <button class="example-tab" data-example="ts">TypeScript</button>
            <button class="example-tab" data-example="js">JavaScript</button>
          </div>
          <pre id="aligned-example-code" class="code-display">// C++ - Direct struct access in WASM
#include "aligned_types.h"

void processEntities(Entity* entities, size_t count) {
    for (size_t i = 0; i &lt; count; i++) {
        Entity&amp; e = entities[i];
        e.health -= 10;
        e.position.x += e.velocity.x * dt;
        // Zero overhead - direct memory access
    }
}

// Export for JS binding
extern "C" void update_entities(Entity* ptr, int count) {
    processEntities(ptr, count);
}</pre>
        </div>
      </div>

      <!-- WASM Interop Patterns -->
      <div class="glass-card">
        <h3 class="card-subtitle">WASM Interop Patterns</h3>
        <p class="card-desc">Since aligned structs have no embedded length metadata, array bounds must be communicated out-of-band. Here are common patterns for sharing data between WASM modules:</p>

        <div class="interop-patterns">
          <!-- Pattern Tabs -->
          <div class="pattern-tabs">
            <button class="pattern-tab active" data-pattern="pointer-count">Pointer + Count</button>
            <button class="pattern-tab" data-pattern="index-lookup">Index Lookup</button>
            <button class="pattern-tab" data-pattern="manifest">Manifest + Data</button>
          </div>

          <!-- Pattern 1: Pointer + Count -->
          <div id="pattern-pointer-count" class="pattern-content active">
            <div class="pattern-desc">
              <strong>Best for:</strong> Simple arrays where producer owns the data
            </div>
            <pre class="code-display">// C++ WASM - Export pointer and count separately
static Cartesian3 positions[10000];
static uint32_t count = 0;

extern "C" {
  Cartesian3* get_positions() { return positions; }
  uint32_t get_count() { return count; }
}

// TypeScript - Read using exported functions
const ptr = wasm.exports.get_positions();
const count = wasm.exports.get_count();
const positions = Cartesian3ArrayView.fromMemory(wasm.memory, ptr, count);

for (const pos of positions) {
  console.log(`(${pos.x}, ${pos.y}, ${pos.z})`);
}</pre>
          </div>

          <!-- Pattern 2: Index Lookup -->
          <div id="pattern-index-lookup" class="pattern-content">
            <div class="pattern-desc">
              <strong>Best for:</strong> Cross-references between structs, sparse access patterns
            </div>
            <pre class="code-display">// Schema - Store indices instead of pointers
struct Cartesian3 { x: double; y: double; z: double; }

table Satellite {
  norad_id: uint32;
  position_index: uint32;  // Index into positions array
  velocity_index: uint32;  // Index into velocities array
}

// TypeScript - Compute offset from index
const CARTESIAN3_SIZE = 24;  // 3 doubles  8 bytes

class SpaceData {
  constructor(memory, positionsBase, satellitesBase) {
    this.memory = memory;
    this.positionsBase = positionsBase;
    this.satellitesBase = satellitesBase;
  }

  // O(1) lookup by index
  getPositionByIndex(index) {
    const offset = this.positionsBase + index * CARTESIAN3_SIZE;
    return Cartesian3View.fromMemory(this.memory, offset);
  }

  // Follow cross-reference from satellite to position
  getSatellitePosition(satIndex) {
    const sat = this.getSatelliteByIndex(satIndex);
    return this.getPositionByIndex(sat.position_index);
  }
}</pre>
          </div>

          <!-- Pattern 3: Manifest + Data -->
          <div id="pattern-manifest" class="pattern-content">
            <div class="pattern-desc">
              <strong>Best for:</strong> Multiple arrays with shared indexing, ephemeris data
            </div>
            <pre class="code-display">// Schema - Manifest with indices into data array
table EphemerisManifest {
  satellite_ids: [uint32:100];
  start_indices: [uint32:100];   // Where each satellite's data starts
  point_counts: [uint32:100];    // How many points per satellite
  total_satellites: uint32;
}

struct EphemerisPoint {
  julian_date: double;
  x: double; y: double; z: double;
  vx: double; vy: double; vz: double;
}

// TypeScript - Navigate using manifest
const POINT_SIZE = 56;  // 7 doubles  8 bytes

class EphemerisReader {
  constructor(memory, manifestPtr, pointsPtr) {
    this.manifest = EphemerisManifestView.fromMemory(memory, manifestPtr);
    this.pointsBase = pointsPtr;
    this.memory = memory;
  }

  // Get all points for a satellite
  getSatellitePoints(satIndex) {
    const startIdx = this.manifest.start_indices[satIndex];
    const count = this.manifest.point_counts[satIndex];
    const offset = this.pointsBase + startIdx * POINT_SIZE;
    return new EphemerisPointArrayView(this.memory.buffer, offset, count);
  }

  // Get specific point: base + (startIndex + timeIndex) * size
  getPoint(satIndex, timeIndex) {
    const startIdx = this.manifest.start_indices[satIndex];
    const offset = this.pointsBase + (startIdx + timeIndex) * POINT_SIZE;
    return EphemerisPointView.fromMemory(this.memory, offset);
  }
}</pre>
          </div>
        </div>

        <div class="compliance-note" style="margin-top: 1rem;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4M12 8h.01"/>
          </svg>
          <span><strong>Key Formula:</strong> <code>byte_offset = base_ptr + index  STRUCT_SIZE</code>  Since struct sizes are fixed and known at compile time, any index can be converted to a byte offset with a single multiplication.</span>
        </div>
      </div>
    </section>

    <!-- WASM Runtimes Section -->
    <section id="runtimes-tab" class="content-section">
      <div class="section-header">
        <h2 class="section-title">WASM Runtime Integration</h2>
        <p class="section-desc">Run the encryption module in any language with WebAssembly support</p>
      </div>

      <!-- Introduction Card -->
      <div class="glass-card">
        <h3 class="card-subtitle">Why WASM Runtimes?</h3>
        <div class="runtime-intro">
          <div class="runtime-benefit">
            <div class="benefit-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
              </svg>
            </div>
            <div class="benefit-content">
              <h4>Single Auditable Implementation</h4>
              <p>One C++/Crypto++ codebase compiled to WASM. Audit once, deploy everywhere.</p>
            </div>
          </div>
          <div class="runtime-benefit">
            <div class="benefit-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 6v6l4 2"/>
              </svg>
            </div>
            <div class="benefit-content">
              <h4>Battle-Tested Crypto</h4>
              <p>Crypto++ has 30+ years of production use in security-critical applications.</p>
            </div>
          </div>
          <div class="runtime-benefit">
            <div class="benefit-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                <polyline points="22,6 12,13 2,6"/>
              </svg>
            </div>
            <div class="benefit-content">
              <h4>Cross-Language Interop</h4>
              <p>Data encrypted in Go can be decrypted in Python, Rust, Java, and vice versa.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Runtime Cards Grid -->
      <div class="glass-card">
        <h3 class="card-subtitle">Available Runtimes</h3>
        <p class="card-desc">Download pre-built bindings and template projects for your language:</p>

        <div class="runtimes-grid">
          <!-- Go Card -->
          <div class="runtime-card" data-lang="go">
            <div class="runtime-header">
              <div class="runtime-icon go">GO</div>
              <div class="runtime-meta">
                <h4>Go</h4>
                <span class="runtime-engine">wazero</span>
              </div>
            </div>
            <p>Pure Go WebAssembly runtime - no CGo required</p>
            <div class="runtime-features">
              <span class="feature-tag">Zero dependencies</span>
              <span class="feature-tag">CGo-free</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="go-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/go.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">go get github.com/tetratelabs/wazero</code>
          </div>

          <!-- Python Card -->
          <div class="runtime-card" data-lang="python">
            <div class="runtime-header">
              <div class="runtime-icon py">PY</div>
              <div class="runtime-meta">
                <h4>Python</h4>
                <span class="runtime-engine">wasmer / wasmtime</span>
              </div>
            </div>
            <p>Run WASM modules with wasmer-python or wasmtime</p>
            <div class="runtime-features">
              <span class="feature-tag">PyPI ready</span>
              <span class="feature-tag">Type hints</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="python-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/python.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">pip install wasmer wasmer-compiler-cranelift</code>
          </div>

          <!-- Rust Card -->
          <div class="runtime-card" data-lang="rust">
            <div class="runtime-header">
              <div class="runtime-icon rs">RS</div>
              <div class="runtime-meta">
                <h4>Rust</h4>
                <span class="runtime-engine">wasmer</span>
              </div>
            </div>
            <p>Native Rust bindings with wasmer crate</p>
            <div class="runtime-features">
              <span class="feature-tag">no_std support</span>
              <span class="feature-tag">Memory safe</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="rust-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/rust.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">cargo add wasmer</code>
          </div>

          <!-- Java Card -->
          <div class="runtime-card" data-lang="java">
            <div class="runtime-header">
              <div class="runtime-icon java">JV</div>
              <div class="runtime-meta">
                <h4>Java</h4>
                <span class="runtime-engine">Chicory</span>
              </div>
            </div>
            <p>Pure Java WASM interpreter - no JNI required</p>
            <div class="runtime-features">
              <span class="feature-tag">Pure Java</span>
              <span class="feature-tag">JNI-free</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="java-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/java.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">com.dylibso.chicory:runtime:1.5.3</code>
          </div>

          <!-- C# Card -->
          <div class="runtime-card" data-lang="csharp">
            <div class="runtime-header">
              <div class="runtime-icon cs">C#</div>
              <div class="runtime-meta">
                <h4>C# / .NET</h4>
                <span class="runtime-engine">Wasmtime</span>
              </div>
            </div>
            <p>.NET 6+ support via Wasmtime NuGet package</p>
            <div class="runtime-features">
              <span class="feature-tag">.NET 6+</span>
              <span class="feature-tag">NuGet</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="csharp-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/csharp.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">dotnet add package Wasmtime</code>
          </div>

          <!-- Swift Card -->
          <div class="runtime-card" data-lang="swift">
            <div class="runtime-header">
              <div class="runtime-icon swift">SW</div>
              <div class="runtime-meta">
                <h4>Swift</h4>
                <span class="runtime-engine">WasmKit</span>
              </div>
            </div>
            <p>Swift Package Manager compatible WASM runtime</p>
            <div class="runtime-features">
              <span class="feature-tag">SPM</span>
              <span class="feature-tag">iOS/macOS</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="swift-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/swift.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">.package(url: "WasmKit.git")</code>
          </div>

          <!-- Node.js Card -->
          <div class="runtime-card" data-lang="nodejs">
            <div class="runtime-header">
              <div class="runtime-icon ts">JS</div>
              <div class="runtime-meta">
                <h4>Node.js</h4>
                <span class="runtime-engine">V8 (native)</span>
              </div>
            </div>
            <p>Native WebAssembly support in Node.js 16+</p>
            <div class="runtime-features">
              <span class="feature-tag">Native V8</span>
              <span class="feature-tag">ESM/CJS</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="nodejs-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/nodejs.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">npm install flatc-wasm</code>
          </div>

          <!-- Browser Card -->
          <div class="runtime-card" data-lang="browser">
            <div class="runtime-header">
              <div class="runtime-icon wasm">WA</div>
              <div class="runtime-meta">
                <h4>Browser</h4>
                <span class="runtime-engine">V8/SpiderMonkey/JSC</span>
              </div>
            </div>
            <p>Works in all modern browsers with WebAssembly</p>
            <div class="runtime-features">
              <span class="feature-tag">All browsers</span>
              <span class="feature-tag">Vite/Webpack</span>
            </div>
            <div class="runtime-actions">
              <button class="glass-btn small primary" data-download="browser-bindings">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download
              </button>
              <a href="docs-html/browser.html" class="glass-btn small">Docs</a>
            </div>
            <code class="install-cmd">npm install flatc-wasm</code>
          </div>
        </div>
      </div>

      <!-- Core Downloads Card -->
      <div class="glass-card">
        <h3 class="card-subtitle">Core WASM Module</h3>
        <p class="card-desc">Download the core encryption module for manual integration:</p>

        <div class="core-downloads">
          <div class="core-download-item">
            <div class="download-icon enc">WA</div>
            <div class="core-download-info">
              <h4>flatc-encryption.wasm</h4>
              <p>Core encryption module compiled from Crypto++ (~1.2MB)</p>
            </div>
            <button id="download-core-wasm" class="glass-btn primary">Download .wasm</button>
          </div>
          <div class="core-download-item">
            <div class="download-icon ts">JS</div>
            <div class="core-download-info">
              <h4>encryption.mjs</h4>
              <p>JavaScript loader with TypeScript definitions</p>
            </div>
            <button id="download-core-loader" class="glass-btn">Download .mjs</button>
          </div>
        </div>
      </div>

      <!-- Documentation Links Card -->
      <div class="glass-card">
        <h3 class="card-subtitle">Documentation</h3>
        <div class="docs-grid">
          <a href="docs-html/README.html" class="doc-link-card">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            <h4>Getting Started</h4>
            <p>Quick start guide for all languages</p>
          </a>
          <a href="docs-html/README.html#api-reference" class="doc-link-card">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="16 18 22 12 16 6"/>
              <polyline points="8 6 2 12 8 18"/>
            </svg>
            <h4>API Reference</h4>
            <p>Complete function documentation</p>
          </a>
          <a href="docs-html/README.html#security" class="doc-link-card">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
            <h4>Security Guide</h4>
            <p>Best practices and threat model</p>
          </a>
          <a href="docs-html/README.html#performance" class="doc-link-card">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
            <h4>Performance</h4>
            <p>Optimization and benchmarks</p>
          </a>
        </div>
      </div>
    </section>
  </main>

  <!-- Keys Modal -->
  <div id="keys-modal" class="modal">
    <div class="modal-glass modal-wide">
      <div class="modal-header">
        <h3>Your Keys</h3>
        <span class="key-warning-header">Private keys stored in memory only</span>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <!-- Quick Derive Buttons (moved to top) -->
        <div class="quick-derive">
          <span class="quick-label">Quick derive:</span>
          <button class="glass-btn small" data-coin="0" data-purpose="84">BTC</button>
          <button class="glass-btn small" data-coin="60" data-purpose="44">ETH</button>
          <button class="glass-btn small" data-coin="501" data-purpose="44">SOL</button>
          <button class="glass-btn small" data-coin="2" data-purpose="44">LTC</button>
          <button class="glass-btn small" data-coin="3" data-purpose="44">DOGE</button>
        </div>

        <!-- HD Wallet Section -->
        <div class="keys-section hd-section">
          <h4 class="section-label">HD Wallet Derivation (BIP44)</h4>

          <div class="hd-path-builder">
            <div class="path-display">
              <span class="path-prefix">m/</span>
              <span class="path-segment">
                <select id="hd-purpose" class="glass-select compact">
                  <option value="44">44' (BIP44)</option>
                  <option value="49">49' (BIP49 SegWit)</option>
                  <option value="84">84' (BIP84 Native SegWit)</option>
                </select>
              </span>
              <span class="path-sep">/</span>
              <span class="path-segment">
                <select id="hd-coin" class="glass-select compact">
                  <option value="0" data-symbol="BTC" data-name="Bitcoin">0' (Bitcoin)</option>
                  <option value="60" data-symbol="ETH" data-name="Ethereum">60' (Ethereum)</option>
                  <option value="501" data-symbol="SOL" data-name="Solana">501' (Solana)</option>
                  <option value="2" data-symbol="LTC" data-name="Litecoin">2' (Litecoin)</option>
                  <option value="145" data-symbol="BCH" data-name="Bitcoin Cash">145' (Bitcoin Cash)</option>
                  <option value="3" data-symbol="DOGE" data-name="Dogecoin">3' (Dogecoin)</option>
                  <option value="118" data-symbol="ATOM" data-name="Cosmos">118' (Cosmos)</option>
                  <option value="330" data-symbol="ALGO" data-name="Algorand">330' (Algorand)</option>
                  <option value="354" data-symbol="DOT" data-name="Polkadot">354' (Polkadot)</option>
                  <option value="1815" data-symbol="ADA" data-name="Cardano">1815' (Cardano)</option>
                </select>
              </span>
              <span class="path-sep">/</span>
              <span class="path-segment">
                <input type="number" id="hd-account" class="glass-input compact" value="0" min="0" max="2147483647">
                <span class="hardened-mark">'</span>
              </span>
              <span class="path-sep">/</span>
              <span class="path-segment">
                <select id="hd-change" class="glass-select compact">
                  <option value="0">0 (External)</option>
                  <option value="1">1 (Change)</option>
                </select>
              </span>
              <span class="path-sep">/</span>
              <span class="path-segment">
                <input type="number" id="hd-index" class="glass-input compact" value="0" min="0" max="2147483647">
              </span>
            </div>

            <div class="path-summary">
              <code id="full-path">m/44'/0'/0'/0/0</code>
            </div>
          </div>

          <!-- HD Wallet Not Initialized Message -->
          <div id="hd-not-initialized" class="hd-not-initialized" style="display: none;">
            <p>HD wallet not initialized. Please log out and log back in with your password or seed phrase to enable HD derivation.</p>
          </div>

          <!-- Derived Address Display -->
          <div id="derived-result" class="derived-result" style="display: none;">
            <div class="derived-header">
              <span class="crypto-icon" id="derived-icon"></span>
              <span class="crypto-name" id="derived-crypto-name">Bitcoin</span>
            </div>

            <div class="key-item">
              <label>Public Key</label>
              <code id="derived-pubkey"></code>
            </div>

            <div class="key-item">
              <label>Address</label>
              <div class="address-row">
                <code id="derived-address"></code>
                <a id="derived-explorer-link" href="#" target="_blank" class="explorer-link glass-btn small">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline>
                    <line x1="10" y1="14" x2="21" y2="3"></line>
                  </svg>
                  View on Explorer
                </a>
              </div>
            </div>

            <div class="balance-qr-row">
              <div class="balance-section" id="balance-row" style="display: none;">
                <span class="balance-label">Balance:</span>
                <span class="balance-value" id="derived-balance">Loading...</span>
              </div>
              <div class="qr-section">
                <canvas id="address-qr" width="96" height="96"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Base Keys Section (collapsible) -->
        <details class="keys-section collapsible-section">
          <summary class="section-label collapsible-header">
            <span>Base Keys</span>
            <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </summary>
          <div class="collapsible-content">
            <div class="key-item">
              <label>X25519 Public Key (Encryption)</label>
              <code id="wallet-x25519-pub"></code>
            </div>
            <div class="key-item">
              <label>Ed25519 Public Key (Signing)</label>
              <code id="wallet-ed25519-pub"></code>
            </div>
            <div class="key-item">
              <label>secp256k1 Public Key (Bitcoin/Ethereum)</label>
              <code id="wallet-secp256k1-pub"></code>
            </div>
          </div>
        </details>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="help-modal" class="modal">
    <div class="modal-glass">
      <div class="modal-header">
        <h3 id="help-title"></h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body" id="help-body"></div>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="login-modal" class="modal">
    <div class="modal-glass login-modal-content">
      <div class="modal-header">
        <h3>Login</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="method-tabs">
          <button class="method-tab active" data-method="password">Password</button>
          <button class="method-tab" data-method="seed">Seed Phrase</button>
          <button class="method-tab" data-method="stored" id="stored-tab" style="display: none;">Stored</button>
        </div>

        <form id="password-method" class="method-content active" onsubmit="return false;">
          <div class="glass-input-group">
            <input type="text" id="wallet-username" class="glass-input" placeholder="Username" autocomplete="username">
          </div>
          <div class="glass-input-group">
            <input type="password" id="wallet-password" class="glass-input" placeholder="Password (24+ chars)" autocomplete="new-password">
            <div class="entropy-bar">
              <div class="entropy-fill" id="strength-fill"></div>
            </div>
            <span class="entropy-label"><span id="entropy-bits">0</span> bits entropy</span>
          </div>
          <div class="remember-wallet-group">
            <label class="glass-checkbox">
              <input type="checkbox" id="remember-wallet-password">
              <span class="checkmark"></span>
              <span>Remember wallet</span>
            </label>
            <div class="remember-options" id="remember-options-password" style="display: none;">
              <div class="remember-method-selector">
                <button type="button" class="remember-method-btn" data-method="pin" data-target="password">PIN</button>
                <button type="button" class="remember-method-btn active" data-method="passkey" data-target="password" id="passkey-btn-password">Passkey</button>
              </div>
              <div class="pin-input-group" id="pin-group-password" style="display: none;">
                <input type="password" id="pin-input-password" class="glass-input pin-input" placeholder="6-digit PIN" maxlength="6" inputmode="numeric" pattern="[0-9]*">
              </div>
              <div class="passkey-info" id="passkey-info-password">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2a5 5 0 0 1 5 5v3H7V7a5 5 0 0 1 5-5z"/>
                  <rect x="3" y="10" width="18" height="12" rx="2"/>
                  <circle cx="12" cy="16" r="1"/>
                </svg>
                <span>Use Face ID, Touch ID, or device PIN</span>
              </div>
            </div>
          </div>
          <button id="derive-from-password" class="glass-btn primary full-width" disabled type="button">
            Login
          </button>
        </form>

        <div id="seed-method" class="method-content">
          <div class="glass-input-group">
            <textarea id="seed-phrase" class="glass-input glass-textarea" rows="3" placeholder="Enter 12 or 24 word seed phrase..."></textarea>
            <div class="seed-actions">
              <button id="generate-seed" class="glass-btn small">Generate</button>
              <button id="validate-seed" class="glass-btn small">Validate</button>
            </div>
          </div>
          <div class="remember-wallet-group">
            <label class="glass-checkbox">
              <input type="checkbox" id="remember-wallet-seed">
              <span class="checkmark"></span>
              <span>Remember wallet</span>
            </label>
            <div class="remember-options" id="remember-options-seed" style="display: none;">
              <div class="remember-method-selector">
                <button type="button" class="remember-method-btn" data-method="pin" data-target="seed">PIN</button>
                <button type="button" class="remember-method-btn active" data-method="passkey" data-target="seed" id="passkey-btn-seed">Passkey</button>
              </div>
              <div class="pin-input-group" id="pin-group-seed" style="display: none;">
                <input type="password" id="pin-input-seed" class="glass-input pin-input" placeholder="6-digit PIN" maxlength="6" inputmode="numeric" pattern="[0-9]*">
              </div>
              <div class="passkey-info" id="passkey-info-seed">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2a5 5 0 0 1 5 5v3H7V7a5 5 0 0 1 5-5z"/>
                  <rect x="3" y="10" width="18" height="12" rx="2"/>
                  <circle cx="12" cy="16" r="1"/>
                </svg>
                <span>Use Face ID, Touch ID, or device PIN</span>
              </div>
            </div>
          </div>
          <button id="derive-from-seed" class="glass-btn primary full-width" disabled>
            Login
          </button>
        </div>

        <div id="stored-method" class="method-content">
          <div class="stored-wallet-info">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
            <p>Encrypted wallet found</p>
            <span class="stored-wallet-date" id="stored-wallet-date"></span>
          </div>
          <div id="stored-pin-section">
            <div class="glass-input-group">
              <input type="password" id="pin-input-unlock" class="glass-input pin-input-large" placeholder="Enter 6-digit PIN" maxlength="6" inputmode="numeric" pattern="[0-9]*">
            </div>
            <button id="unlock-stored-wallet" class="glass-btn primary full-width" disabled>
              Unlock with PIN
            </button>
          </div>
          <div id="stored-passkey-section" style="display: none;">
            <button id="unlock-with-passkey" class="glass-btn primary full-width passkey-unlock-btn">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2a5 5 0 0 1 5 5v3H7V7a5 5 0 0 1 5-5z"/>
                <rect x="3" y="10" width="18" height="12" rx="2"/>
                <circle cx="12" cy="16" r="1"/>
              </svg>
              Unlock with Passkey
            </button>
          </div>
          <div class="stored-divider" id="stored-divider" style="display: none;">
            <span>or</span>
          </div>
          <button id="forget-stored-wallet" class="glass-btn secondary full-width">
            Forget Wallet
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <span id="status">Loading WASM modules...</span>
  </div>

  <!-- Floating Contact Footer -->
  <footer class="floating-footer" id="floating-footer">
    <a href="javascript:void(0)" data-u="tj" data-d="digitalarsenal.io"></a>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script type="module" src="app.mjs"></script>
  <script>
    // Obfuscated email protection - assembled at runtime to prevent scraping
    document.querySelectorAll('a[data-u][data-d]').forEach(a => {
      const e = a.dataset.u + '@' + a.dataset.d;
      a.textContent = e;
      a.addEventListener('click', (evt) => {
        evt.preventDefault();
        window.location.href = 'mailto:' + e;
      });
    });

    // Show/hide floating footer based on hero contact visibility
    const heroContact = document.querySelector('.contact-info');
    const floatingFooter = document.getElementById('floating-footer');

    if (heroContact && floatingFooter) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          // Hide footer when hero contact is visible, show when not visible
          floatingFooter.classList.toggle('visible', !entry.isIntersecting);
        });
      }, { threshold: 0 });

      observer.observe(heroContact);
    }
  </script>
</body>
</html>
